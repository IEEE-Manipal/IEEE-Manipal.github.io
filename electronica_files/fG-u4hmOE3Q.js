if (self.CavalryLogger) { CavalryLogger.start_js(["B4KNz"]); }

__d("PinnedConversationNubsActionTaken",[],(function a(b,c,d,e,f,g){f.exports={TAB_CLOSED_BY_USER:0,COMMENT_ADDED:1};}),null);
__d('ConversationNub',['csx','cx','Arbiter','ConversationNubHeader','ConversationNubTabsUpdateEventController','ConversationNubUtils','CSS','DOM','EventListener','NotificationUserActions','PinnedConversationNubsConfig','SubscriptionsHandler','UFIComposerIsTypingStore','URI','containsNode','ConversationNubTabState','debounce','guid'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=c('ConversationNubTabsUpdateEventController').minimizeAndInformTabUpdate,k=c('ConversationNubTabsUpdateEventController').popOutAndInformTabUpdate,l=c('ConversationNubTabState'),m=10,n=500,o=100;p.createDefaultState=function(q,r,s,t,u,v){return {tabID:q,permalinkURI:r?new (c('URI'))(r):null,ftID:s,notifAlertID:t,notificationType:u,title:v,keepAtBottom:false,isTabRaised:false,isBlinkingUnread:false,badgeCount:0,allSeenNewComments:{},unseenCommentsSinceLastCleared:{},hasFakeInitBadge:false};};function p(q,r,s){var t=arguments.length<=3||arguments[3]===undefined?false:arguments[3],u=arguments.length<=4||arguments[4]===undefined?false:arguments[4];this.$ConversationNub13=false;this.$ConversationNub14=false;this.$ConversationNub1=q;this.$ConversationNub12=r;this.$ConversationNub5=c('guid')();this.$ConversationNub7=null;this.$ConversationNub8=false;this.$ConversationNub9=null;this.$ConversationNub10=t;this.$ConversationNub11=u;this.$ConversationNub6=new (c('SubscriptionsHandler'))();this.$ConversationNub15();this.$ConversationNub16();if(s!=null)l.modifyTabState(this.$ConversationNub12,function(v){if(s){v.hasFakeInitBadge=false;}else{v.hasFakeInitBadge=true;this.$ConversationNub17(1);this.$ConversationNub18(true);}}.bind(this));this.$ConversationNub19();}p.prototype.$ConversationNub19=function(){this.$ConversationNub20();this.$ConversationNub21();c('ConversationNubUtils').informShouldRecheckTabVisibility(this);this.forceReflow();};p.prototype.getPersistentState=function(){return l.getTabState(this.$ConversationNub12);};p.prototype.getPersistentStateIfExists=function(){return l.getTabStateIfExists(this.$ConversationNub12);};p.prototype.$ConversationNub15=function(){var q=this.$ConversationNub22();if(q){this.$ConversationNub6.addSubscriptions(c('EventListener').listen(q,'click',this.$ConversationNub23.bind(this)),c('EventListener').listen(q,'mouseenter',this.$ConversationNub24.bind(this)),c('EventListener').listen(q,'mouseleave',this.$ConversationNub25.bind(this)));var r=c('ConversationNubUtils').getCloseButtonElem(q);if(r)c('ConversationNubUtils').addCloseButtonListeners(r,this.$ConversationNub6,this.$ConversationNub26.bind(this));}var s=this.$ConversationNub27();if(s){l.modifyTabState(this.$ConversationNub12,function(u){u.keepAtBottom=true;});this.$ConversationNub6.addSubscriptions(c('EventListener').listen(s,'scroll',c('debounce')(this.$ConversationNub28.bind(this),o)),c('Arbiter').subscribe('reflow',this.$ConversationNub29.bind(this)));}var t=this.$ConversationNub30();if(t)this.$ConversationNub6.addSubscriptions(c('EventListener').listen(t,'focusin',this.$ConversationNub31.bind(this,true)),c('EventListener').listen(t,'focusout',this.$ConversationNub31.bind(this,false)));};p.prototype.$ConversationNub16=function(){var q=this.$ConversationNub32();if(!q){this.$ConversationNub2=null;return;}var r=function(){var t=this.getPersistentState();return {permalinkURI:t.permalinkURI,ftID:t.ftID,tabID:t.tabID};}.bind(this),s=new (c('ConversationNubHeader'))(q,r);this.$ConversationNub6.addSubscriptions(s.subscribe('closeButton',this.$ConversationNub26.bind(this)),s.subscribe('showMenu',this.$ConversationNub33.bind(this)),s.subscribe('hideMenu',this.$ConversationNub34.bind(this)),s.subscribe('minimizeButton',this.$ConversationNub35.bind(this,true)),s.subscribe('clickHeader',this.$ConversationNub35.bind(this,true)),s.subscribe('menuPermalinkClick',this.$ConversationNub35.bind(this,false)),c('UFIComposerIsTypingStore').addListener(function(){var t=this.getPersistentStateIfExists();if(!t)return;var u=this.$ConversationNub14,v=c('UFIComposerIsTypingStore').getValueFor(t.ftID);this.$ConversationNub14=v===true;if(u!==this.$ConversationNub14)c('ConversationNubTabsUpdateEventController').informTabsUpdated();}.bind(this)));this.$ConversationNub2=s;};p.prototype.$ConversationNub32=function(){return this.$ConversationNub1&&c('DOM').scry(this.$ConversationNub1,".fbNubFlyoutTitlebar")[0];};p.prototype.$ConversationNub22=function(){return this.$ConversationNub1&&c('DOM').scry(this.$ConversationNub1,".fbNubButton")[0];};p.prototype.$ConversationNub27=function(){if(!this.$ConversationNub3&&this.$ConversationNub1)this.$ConversationNub3=c('DOM').scry(this.$ConversationNub1,".uiScrollableAreaWrap")[0];return this.$ConversationNub3;};p.prototype.$ConversationNub30=function(){if(!this.$ConversationNub4&&this.$ConversationNub1)this.$ConversationNub4=c('DOM').scry(this.$ConversationNub1,".fbNubFlyoutBodyContent")[0];return this.$ConversationNub4;};p.prototype.$ConversationNub36=function(){var q=this.$ConversationNub22();if(q)return c('DOM').scry(q,"._37op")[0];return null;};p.prototype.$ConversationNub26=function(){c('ConversationNubUtils').informShouldCloseTab(this.$ConversationNub12,this.getFeedbackTargetID(),c('ConversationNubUtils').CLOSE_REASON_TAB_X_OUT);};p.prototype.$ConversationNub35=function(q){j(this,q);};p.prototype.$ConversationNub33=function(){this.$ConversationNub1&&c('CSS').addClass(this.$ConversationNub1,"_1uw3");};p.prototype.$ConversationNub34=function(){this.$ConversationNub1&&c('CSS').removeClass(this.$ConversationNub1,"_1uw3");};p.prototype.$ConversationNub23=function(){if(this.getPersistentState().isTabRaised){j(this,true);}else k(this,true);};p.prototype.$ConversationNub24=function(){if(this.getPersistentState().isBlinkingUnread)this.$ConversationNub9=new Date();};p.prototype.$ConversationNub25=function(){var q=this.$ConversationNub9;if(q&&this.getPersistentState().isBlinkingUnread){var r=new Date();if(r-q>=n)this.$ConversationNub18(false);}this.$ConversationNub9=null;};p.prototype.$ConversationNub37=function(){var q=this.$ConversationNub27();if(q){var r=q.scrollHeight;if(r>0&&!this.$ConversationNub38(q)){this.$ConversationNub8=true;q.scrollTop=r;}}};p.prototype.$ConversationNub38=function(q){q=q||this.$ConversationNub27();return !!(q&&q.scrollTop>=q.scrollHeight-q.clientHeight-m);};p.prototype.$ConversationNub28=function(){if(!l.getTabStateIfExists(this.$ConversationNub12)||!this.getPersistentState().isTabRaised)return;l.modifyTabState(this.$ConversationNub12,function(q){q.keepAtBottom=this.$ConversationNub38();c('ConversationNubUtils').informShouldRecheckTabVisibility(this);}.bind(this));if(!this.$ConversationNub8)this.clearJewelNotifications();this.$ConversationNub8=false;};p.prototype.$ConversationNub31=function(q){if(this.$ConversationNub13===q)return;this.$ConversationNub13=q;if(this.$ConversationNub13)this.clearJewelNotifications();c('ConversationNubTabsUpdateEventController').informTabsUpdated();};p.prototype.getIsFocused=function(){return this.$ConversationNub13;};p.prototype.getHasText=function(){return this.$ConversationNub14;};p.prototype.$ConversationNub29=function(){var q=this.getPersistentState();if(!q.isTabRaised)return;if(q.keepAtBottom){this.$ConversationNub37();this.$ConversationNub7&&clearTimeout(this.$ConversationNub7);this.$ConversationNub7=setTimeout(function(){if(q.keepAtBottom)this.$ConversationNub37();}.bind(this),100);}};p.prototype.$ConversationNub17=function(q){l.modifyTabState(this.$ConversationNub12,function(r){r.badgeCount=q;this.$ConversationNub20();}.bind(this));};p.prototype.$ConversationNub18=function(q){l.modifyTabState(this.$ConversationNub12,function(r){r.isBlinkingUnread=q;this.$ConversationNub21();}.bind(this));};p.prototype.$ConversationNub20=function(){var q=this.$ConversationNub36();if(!q)return;var r=this.getPersistentState().badgeCount,s=r>0;if(s){c('DOM').setContent(q,r);c('CSS').show(q);}else{c('CSS').hide(q);c('DOM').setContent(q,r);}};p.prototype.$ConversationNub21=function(){if(this.$ConversationNub1){var q=this.getPersistentState().isBlinkingUnread;c('CSS').conditionClass(this.$ConversationNub1,"_53tf",q);}};p.prototype.getRootDOM=function(){return this.$ConversationNub1;};p.prototype.getShouldShowIntroNux=function(){return this.$ConversationNub10;};p.prototype.getShouldShowHideNux=function(){return this.$ConversationNub11;};p.prototype.getTabID=function(){return this.$ConversationNub12;};p.prototype.getNotificationAlertID=function(){return this.getPersistentState().notifAlertID;};p.prototype.getNotificationType=function(){return this.getPersistentState().notificationType;};p.prototype.setNotificationType=function(q){l.modifyTabState(this.$ConversationNub12,function(r){r.notificationType=q;});};p.prototype.getFeedbackTargetID=function(){return this.getPersistentState().ftID;};p.prototype.getPermalinkURI=function(){return this.getPersistentState().permalinkURI;};p.prototype.getTitle=function(){return this.getPersistentState().title;};p.prototype.getBadgeCount=function(){return this.getPersistentState().badgeCount;};p.prototype.getIsRaised=function(){return this.getPersistentState().isTabRaised;};p.prototype.getSessionID=function(){return this.$ConversationNub5;};p.prototype.markCommentsAsSeenWithoutBadging=function(q){l.modifyTabState(this.$ConversationNub12,function(r){q.forEach(function(s){r.allSeenNewComments[s]=true;});});};p.prototype.attemptAddNewCommentsToBadge=function(q){l.modifyTabState(this.$ConversationNub12,function(r){q.forEach(function(u){if(r.allSeenNewComments[u])return;r.allSeenNewComments[u]=true;r.unseenCommentsSinceLastCleared[u]=true;});var s=Object.keys(r.unseenCommentsSinceLastCleared).length;if(r.hasFakeInitBadge)s+=1;var t=r.badgeCount;this.$ConversationNub17(s);this.$ConversationNub18(s>0&&s>t);}.bind(this));};p.prototype.clearBadge=function(){l.clearTabNotifications(this.$ConversationNub12);this.$ConversationNub20();this.$ConversationNub21();};p.prototype.clearJewelNotifications=function(){if(c('PinnedConversationNubsConfig').sharedNotificationsReadStateEnabled){var q=this.getNotificationAlertID();if(q)c('NotificationUserActions').markNotificationsAsRead([q]);}};p.prototype.popOutAndInformTabUpdate=function(){this.popOut();c('ConversationNubTabsUpdateEventController').informTabsUpdated();};p.prototype.popOut=function(){l.modifyTabState(this.$ConversationNub12,function(q){if(this.$ConversationNub1)c('CSS').addClass(this.$ConversationNub1,"_5r93");q.isTabRaised=true;this.clearBadge();if(q.keepAtBottom)this.$ConversationNub37();}.bind(this));};p.prototype.minimize=function(){l.modifyTabState(this.$ConversationNub12,function(q){if(this.$ConversationNub1)c('CSS').removeClass(this.$ConversationNub1,"_5r93");q.isTabRaised=false;this.$ConversationNub2&&this.$ConversationNub2.hideMenu();this.clearBadge();}.bind(this));};p.prototype.forceReflow=function(){this.$ConversationNub29();};p.prototype.isFormForThisUFI=function(q){return this.$ConversationNub1&&c('containsNode')(this.$ConversationNub1,q);};p.prototype.destroy=function(){this.$ConversationNub6.release();this.$ConversationNub2&&this.$ConversationNub2.destroy();this.$ConversationNub2=null;this.$ConversationNub7&&clearTimeout(this.$ConversationNub7);this.minimize();if(this.$ConversationNub1){c('DOM').remove(this.$ConversationNub1);c('Arbiter').inform('ConversationNub/destroy',{root:this.$ConversationNub1});this.$ConversationNub1=null;}};f.exports=p;}),null);
__d("XConversationNubActionTakenController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/ajax\/conversation\/nub_story\/action_taken\/",{});}),null);
__d('ConversationNubActionTakenReporter',['Arbiter','AsyncRequest','ConversationNubAddCommentSubscription','ConversationNubUtils','PinnedConversationNubsActionTaken','SubscriptionsHandler','XConversationNubActionTakenController'],(function a(b,c,d,e,f,g){'use strict';function h(){this.$ConversationNubActionTakenReporter2=function(i,j){this.$ConversationNubActionTakenReporter4(j,c('PinnedConversationNubsActionTaken').COMMENT_ADDED);}.bind(this);this.$ConversationNubActionTakenReporter3=function(event,i){var j=i.tabID,k=i.ftID,l=i.tabState,m=i.sessionID,n=i.reason;if(n===c('ConversationNubUtils').CLOSE_REASON_TAB_X_OUT||n===c('ConversationNubUtils').CLOSE_REASON_OVERFLOW_X_OUT||n===c('ConversationNubUtils').CLOSE_REASON_UNPIN)this.$ConversationNubActionTakenReporter4(k,c('PinnedConversationNubsActionTaken').TAB_CLOSED_BY_USER);}.bind(this);this.$ConversationNubActionTakenReporter1=new (c('SubscriptionsHandler'))(c('ConversationNubAddCommentSubscription').subscribe(this.$ConversationNubActionTakenReporter2),c('Arbiter').subscribe(c('ConversationNubUtils').CLOSE_TAB_EVENT,this.$ConversationNubActionTakenReporter3));}h.prototype.destroy=function(){this.$ConversationNubActionTakenReporter1.release();};h.prototype.$ConversationNubActionTakenReporter4=function(i,j){var k=c('XConversationNubActionTakenController').getURIBuilder().getURI();new (c('AsyncRequest'))().setURI(k).setMethod('POST').setData({ft_id:i,action:j}).setAllowCrossPageTransition(true).send();};f.exports=h;}),null);
__d('ConversationNubAddCommentSubscription',['Arbiter','UFIUIEvents','ConversationNubTabState'],(function a(b,c,d,e,f,g){'use strict';function h(i){return c('Arbiter').subscribe(c('UFIUIEvents').Comment,function(j,k){var l=k.ft_id,m=k.form;if(!l||!m)return;var n=c('ConversationNubTabState').getLoadedTabByFeedbackTarget(l);if(n&&n.isFormForThisUFI(m))i(n,l);});}f.exports={subscribe:h};}),null);
__d('ConversationNubHeader',['csx','ArbiterMixin','Bootloader','ConversationNubUtils','DOM','Event','EventListener','Keys','SubscriptionsHandler','ifRequired','mixin'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;function k(m,n){return c('EventListener').listen(m,'keydown',function(o){if(c('Event').getKeyCode(o)===c('Keys').RETURN)n(o);});}i=babelHelpers.inherits(l,c('mixin')(c('ArbiterMixin')));j=i&&i.prototype;function l(m,n){j.constructor.call(this);this.$ConversationNubHeader6=false;this.$ConversationNubHeader1=m;this.$ConversationNubHeader3=n;this.$ConversationNubHeader4=null;this.$ConversationNubHeader5=false;this.$ConversationNubHeader2=new (c('SubscriptionsHandler'))();this.$ConversationNubHeader7();}l.prototype.$ConversationNubHeader7=function(){var m=this.$ConversationNubHeader1;this.$ConversationNubHeader2.addSubscriptions(c('EventListener').listen(m,'click',this.$ConversationNubHeader8.bind(this)));var n=c('ConversationNubUtils').getCloseButtonElem(m);if(n)c('ConversationNubUtils').addCloseButtonListeners(n,this.$ConversationNubHeader2,this.$ConversationNubHeader9.bind(this));var o=this.$ConversationNubHeader10();if(o)this.$ConversationNubHeader2.addSubscriptions(c('EventListener').listen(o,'click',this.$ConversationNubHeader11.bind(this)),k(o,this.$ConversationNubHeader11.bind(this)));var p=this.$ConversationNubHeader12();if(p)this.$ConversationNubHeader2.addSubscriptions(c('EventListener').listen(p,'click',this.$ConversationNubHeader13.bind(this)),c('EventListener').listen(p,'mouseover',this.$ConversationNubHeader14.bind(this)),c('EventListener').listen(p,'focus',this.$ConversationNubHeader15.bind(this)),k(p,this.$ConversationNubHeader16.bind(this)));};l.prototype.$ConversationNubHeader12=function(){return c('DOM').scry(this.$ConversationNubHeader1,"._1rf1")[0];};l.prototype.$ConversationNubHeader10=function(){return c('DOM').scry(this.$ConversationNubHeader1,"._4a56")[0];};l.prototype.$ConversationNubHeader17=function(){return c('ConversationNubUtils').getCloseButtonElem(this.$ConversationNubHeader1);};l.prototype.$ConversationNubHeader9=function(){this.inform('closeButton');};l.prototype.$ConversationNubHeader11=function(m){if(m.type==='click')m.kill();this.inform('minimizeButton');};l.prototype.$ConversationNubHeader8=function(){this.inform('clickHeader');};l.prototype.$ConversationNubHeader18=function(){this.inform('showMenu');};l.prototype.$ConversationNubHeader19=function(){this.inform('hideMenu');var m=this.$ConversationNubHeader12();m&&m.blur();};l.prototype.$ConversationNubHeader20=function(){this.inform('menuPermalinkClick');};l.prototype.$ConversationNubHeader21=function(m){if(this.$ConversationNubHeader4)return;var n=this.$ConversationNubHeader12();if(!n)return;if(m)this.$ConversationNubHeader5=true;c('Bootloader').loadModules(["React","ReactDOM","ConversationNubHeaderMenu.react"],function(o,p,q){if(this.$ConversationNubHeader6)return;var r=babelHelpers['extends']({},this.$ConversationNubHeader3(),{onMenuShow:this.$ConversationNubHeader18.bind(this),onMenuHide:this.$ConversationNubHeader19.bind(this),onPermalinkClick:this.$ConversationNubHeader20.bind(this),showOnMount:this.$ConversationNubHeader5});this.$ConversationNubHeader4=p.render(o.createElement(q,r),n);}.bind(this),'ConversationNubHeader');};l.prototype.$ConversationNubHeader13=function(m){m.kill();this.$ConversationNubHeader21(true);};l.prototype.$ConversationNubHeader14=function(){this.$ConversationNubHeader21(false);};l.prototype.$ConversationNubHeader15=function(){this.$ConversationNubHeader21(false);};l.prototype.$ConversationNubHeader16=function(){if(this.$ConversationNubHeader4){this.$ConversationNubHeader4.toggle();}else this.$ConversationNubHeader21(true);};l.prototype.hideMenu=function(){this.$ConversationNubHeader4&&this.$ConversationNubHeader4.hide();};l.prototype.destroy=function(){this.$ConversationNubHeader6=true;var m=this.$ConversationNubHeader12();if(m&&this.$ConversationNubHeader4)c('ifRequired')('ReactDOM',function(n){n.unmountComponentAtNode(m);});this.$ConversationNubHeader2.release();};f.exports=l;}),null);
__d('ConversationNubTabState',['invariant','ConversationNubTabStateList','PinnedConversationNubsConfig'],(function a(b,c,d,e,f,g,h){'use strict';function i(){this.$ConversationNubTabStateClass1=Object.create(null);this.$ConversationNubTabStateClass2=new (c('ConversationNubTabStateList'))();this.$ConversationNubTabStateClass3=Infinity;this.maxTabsLoaded=Infinity;if(c('PinnedConversationNubsConfig').numberOfTabsLimit&&c('PinnedConversationNubsConfig').numberOfTabsLimit>0)this.maxTabsLoaded=c('PinnedConversationNubsConfig').numberOfTabsLimit;}i.prototype.anyTabHasFocus=function(){return this.getUnsortedLoadedTabs().some(function(j){return j.getIsFocused();});};i.prototype.anyTabHasText=function(){return this.getUnsortedLoadedTabs().some(function(j){return j.getHasText();});};i.prototype.getTabState=function(j){return this.$ConversationNubTabStateClass2.getTabState(j);};i.prototype.getTabStateIfExists=function(j){return this.$ConversationNubTabStateClass2.getTabStateIfExists(j);};i.prototype.getUnloadedTabs=function(){var j=this.$ConversationNubTabStateClass2.getTabs().filter(function(k){return !this.getLoadedTab(k.tabID);}.bind(this));return j;};i.prototype.setMaxDockTabs=function(j){this.$ConversationNubTabStateClass3=j;};i.prototype.getNumDockTabs=function(){var j=this.$ConversationNubTabStateClass3,k=this.getTotalTabCount();return Math.min(j,k);};i.prototype.getNumMenuTabs=function(){return this.getTotalTabCount()-this.getNumDockTabs();};i.prototype.addTabState=function(j){this.$ConversationNubTabStateClass2.push(j);};i.prototype.addLoadedTab=function(j,k){var l=this.getTabState(j);if(!l)return;var m=this.getLoadedTab(j);if(m)return;this.$ConversationNubTabStateClass1[j]=k;this.$ConversationNubTabStateClass4();};i.prototype.getLoadedTab=function(j){return this.$ConversationNubTabStateClass1[j];};i.prototype.getLoadedTabByFeedbackTarget=function(j){return this.getLoadedTabs().find(function(k){return k.getPersistentState().ftID===j;});};i.prototype.isTabInDock=function(j){var k=this.getLoadedTab(j);if(!k)return false;var l=this.$ConversationNubTabStateClass5(k);return 0<=l&&l<this.getNumDockTabs();};i.prototype.clearTabNotifications=function(j){this.$ConversationNubTabStateClass2.modifyTabState(j,function(k){k.unseenCommentsSinceLastCleared={};k.hasFakeInitBadge=false;k.badgeCount=0;k.isBlinkingUnread=false;});};i.prototype.deleteTab=function(j){var k=this.getLoadedTab(j);if(k){delete this.$ConversationNubTabStateClass1[j];k.destroy();}this.$ConversationNubTabStateClass2.remove(j);return Boolean(k);};i.prototype.deleteAllTabs=function(){this.getUnsortedLoadedTabs().forEach(function(j){return this.deleteTab(j.getTabID());}.bind(this));};i.prototype.modifyTabState=function(j,k){return this.$ConversationNubTabStateClass2.modifyTabState(j,k);};i.prototype.moveTabToDockLeft=function(j){var k=this.getLoadedTab(j);if(!k)return;this.$ConversationNubTabStateClass2.modifyTabs(function(l){var m=l.findIndex(function(v){return v.tabID===j;});m!==-1||h(0);var n=l[m],o=this.$ConversationNubTabStateClass5(k),p=this.getLoadedTabs().length,q=this.getNumDockTabs();if(o<0||p===0){return l;}else if(q===0){if(o!==0){l.splice(m,1);l.unshift(n);}return l;}var r=q-1;if(o===r)return l;l.splice(m,1);if(o<r)r-=1;var s=this.getLoadedTabs()[r],t=this.getTabState(s.getTabID());t||h(0);var u=l.findIndex(function(v){return v.tabID===t.tabID;});l.splice(u,0,n);return l;}.bind(this));};i.prototype.getLoadedTabs=function(){var j=this.$ConversationNubTabStateClass2.getTabs().map(function(k){return this.getLoadedTab(k.tabID);}.bind(this)).filter(Boolean);return j;};i.prototype.getUnsortedLoadedTabs=function(){var j=Object.values(this.$ConversationNubTabStateClass1);return j;};i.prototype.getTotalTabCount=function(){return this.getUnsortedLoadedTabs().length;};i.prototype.getTabsForDockOldestFirst=function(){return this.getLoadedTabs().slice(0,this.getNumDockTabs());};i.prototype.getTabsForDockNewestFirst=function(){return this.getTabsForDockOldestFirst().slice().reverse();};i.prototype.getTabsForMenuOldestFirst=function(){return this.getLoadedTabs().slice(this.getNumDockTabs());};i.prototype.getTabsForMenuNewestFirst=function(){return this.getLoadedTabs().slice(this.getNumDockTabs()).reverse();};i.prototype.$ConversationNubTabStateClass4=function(){if(this.maxTabsLoaded!==Infinity){var j=this.getLoadedTabs().length;if(j>this.maxTabsLoaded){var k=j-this.maxTabsLoaded,l=this.getTabsForMenuOldestFirst().slice(0,k);l.map(function(m){return m.getTabID();}).forEach(function(m){return this.deleteTab(m);}.bind(this));}}};i.prototype.$ConversationNubTabStateClass5=function(j){return this.getLoadedTabs().indexOf(j);};f.exports=new i();}),null);
__d('PersistedStore',['invariant','EventListener','SubscriptionsHandler','UserAgent','WebStorage','areEqual','deepFreezeValue'],(function a(b,c,d,e,f,g,h){'use strict';function i(j){var k=j.initialValue,l=j.storageKeyPrefix,m=j.serializer,n=j.deserializer,o=j.onDataUpdatedOutOfBand,p=j.onDataUpdatedInOtherBrowserTab,q=j.enablePersistence,r=q===undefined?true:q;this.$PersistedStore2=null;this.$PersistedStore3=null;this.$PersistedStore5=0;this.$PersistedStore12=new (c('SubscriptionsHandler'))();if(r)this.$PersistedStore7=c('WebStorage').getLocalStorage();this.$PersistedStore1=k;this.$PersistedStore4=l;this.$PersistedStore6=l+'.PersistedStoreMetadata';this.$PersistedStore8=m;this.$PersistedStore9=n;this.$PersistedStore10=o;this.$PersistedStore11=p;if(r&&p)this.$PersistedStore14();this.reloadFromStorageIfNecessary();}i.prototype.$PersistedStore14=function(){if(c('UserAgent').isBrowser('Chrome')&&typeof BroadcastChannel==='function'){this.$PersistedStore13=new BroadcastChannel(i.BROADCAST_CHANNEL_NAME);this.$PersistedStore13.onmessage=this.$PersistedStore15.bind(this);}else this.$PersistedStore12.addSubscriptions(c('EventListener').listen(window,'storage',this.$PersistedStore16.bind(this)));};i.prototype.$PersistedStore15=function(j){this.$PersistedStore17();};i.prototype.$PersistedStore16=function(j){if(j.key===this.$PersistedStore4)this.$PersistedStore17();};i.prototype.$PersistedStore17=function(){var j=this.$PersistedStore18();if(j&&this.$PersistedStore11)this.$PersistedStore11(j);};i.prototype.$PersistedStore19=function(j){var k=JSON.stringify(this.$PersistedStore8(j));return this.$PersistedStore9(JSON.parse(k));};i.prototype.$PersistedStore20=function(){return this.$PersistedStore19(this.$PersistedStore1);};i.prototype.isPersisted=function(){return this.$PersistedStore7!=null;};i.prototype.modify=function(j){this.$PersistedStore3=null;if(!this.isPersisted()){this.$PersistedStore1=j(this.$PersistedStore1);}else if(this.$PersistedStore2){this.$PersistedStore2=j(this.$PersistedStore2);}else{var k=void 0;try{this.$PersistedStore2=this.$PersistedStore20();k=j(this.$PersistedStore2);}finally{this.$PersistedStore2=null;}if(k&&!c('areEqual')(this.$PersistedStore1,k)){this.$PersistedStore1=k;this.$PersistedStore21();}}};i.prototype.getData=function(){if(!this.isPersisted()){return this.$PersistedStore1;}else if(this.$PersistedStore3)return this.$PersistedStore3;var j=void 0;if(this.$PersistedStore2){j=this.$PersistedStore19(this.$PersistedStore2);c('deepFreezeValue')(j);}else{j=this.$PersistedStore20();c('deepFreezeValue')(j);this.$PersistedStore3=j;}return j;};i.prototype.$PersistedStore22=function(j){if(this.$PersistedStore7!=null)if(j>i.VERSION){this.$PersistedStore7=null;}else if(j<i.VERSION){this.$PersistedStore7.removeItem(this.$PersistedStore6);this.$PersistedStore7.removeItem(this.$PersistedStore4);}else return true;return false;};i.prototype.$PersistedStore23=function(){try{if(this.$PersistedStore7!=null){var k=this.$PersistedStore7.getItem(this.$PersistedStore6);if(k!=null){var l=JSON.parse(k),m=Number.parseInt(l.highWaterMark,10),n=Number.parseInt(l.version,10);if(m&&n)return {highWaterMark:m,version:n};}}}catch(j){this.$PersistedStore7=null;}return null;};i.prototype.reloadFromStorageIfNecessary=function(){if(!this.isPersisted())return;var j=this.$PersistedStore23();if(j){var k=j.highWaterMark,l=j.version;if(this.$PersistedStore22(l)&&this.$PersistedStore5<k)this.$PersistedStore24(k);}};i.prototype.$PersistedStore24=function(j){var k=this.$PersistedStore18();if(k)this.$PersistedStore25(k,j);};i.prototype.$PersistedStore18=function(){var j=null;try{if(this.$PersistedStore7){var l=this.$PersistedStore7.getItem(this.$PersistedStore4);if(l!=null)j=JSON.parse(l);}}catch(k){this.$PersistedStore7=null;}return this.$PersistedStore9(j);};i.prototype.$PersistedStore25=function(j,k){this.$PersistedStore3=null;var l=this.$PersistedStore1;this.$PersistedStore1=j;this.$PersistedStore5=k;this.$PersistedStore10(l,j);};i.prototype.$PersistedStore21=function(){this.reloadFromStorageIfNecessary();if(!this.isPersisted())return;var j=this.$PersistedStore8(this.$PersistedStore1),k=JSON.stringify(j),l={highWaterMark:++this.$PersistedStore5,version:i.VERSION},m=JSON.stringify(l);try{this.$PersistedStore7!=null||h(0);this.$PersistedStore7.setItem(this.$PersistedStore6,m);this.$PersistedStore7.setItem(this.$PersistedStore4,k);if(this.$PersistedStore13)this.$PersistedStore13.postMessage(i.BROADCAST_CHANNEL_NAME);}catch(n){this.$PersistedStore7=null;}};i.prototype.$PersistedStore26=function(){this.$PersistedStore12.release();if(this.$PersistedStore13)this.$PersistedStore13.close();};i.VERSION=24;i.BROADCAST_CHANNEL_NAME='PersistedStoreMessage-StorageUpdated';f.exports=i;}),null);
__d('filterSet',['Set'],(function a(b,c,d,e,f,g){'use strict';function h(i,j){var k=new (c('Set'))();for(var l=i,m=Array.isArray(l),n=0,l=m?l:l[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var o;if(m){if(n>=l.length)break;o=l[n++];}else{n=l.next();if(n.done)break;o=n.value;}var p=o;if(j(p))k.add(p);}return k;}f.exports=h;}),null);
__d('differenceSets',['filterSet'],(function a(b,c,d,e,f,g){'use strict';function h(i){for(var j=arguments.length,k=Array(j>1?j-1:0),l=1;l<j;l++)k[l-1]=arguments[l];return c('filterSet')(i,function(m){return !k.some(function(n){return n.has(m);});});}f.exports=h;}),null);
__d('ConversationNubTabStateList',['invariant','ConversationNubUtils','PersistedStore','PinnedConversationNubsConfig','Set','URI','differenceSets'],(function a(b,c,d,e,f,g,h){'use strict';function i(){this.$ConversationNubTabStateList2=new (c('Set'))();var j=c('PinnedConversationNubsConfig').syncTabCloseEnabled?this.$ConversationNubTabStateList3.bind(this):undefined;this.$ConversationNubTabStateList1=new (c('PersistedStore'))({initialValue:[],storageKeyPrefix:'conversationNubTabState',serializer:i.serializeStateArrayToJson,deserializer:i.deserializeJsonToStateArray,onDataUpdatedOutOfBand:this.$ConversationNubTabStateList4.bind(this),onDataUpdatedInOtherBrowserTab:j,enablePersistence:c('PinnedConversationNubsConfig').persistenceEnabled});}i.prototype.modifyTabState=function(j,k){this.modifyTabs(function(l){var m=l.findIndex(function(n){return n.tabID===j;});m!==-1||h(0);k(l[m]);return l;});};i.prototype.$ConversationNubTabStateList5=function(j){return new (c('Set'))(j.map(function(k){return k.tabID;}));};i.prototype.modifyTabs=function(j){try{this.$ConversationNubTabStateList1.modify(function(k){var l=this.$ConversationNubTabStateList5(k),m=j(k),n=this.$ConversationNubTabStateList5(m);this.$ConversationNubTabStateList2=c('differenceSets')(l,n);return m;}.bind(this));}finally{this.$ConversationNubTabStateList2=new (c('Set'))();}};i.prototype.getTabs=function(){return this.$ConversationNubTabStateList1.getData();};i.prototype.getTabState=function(j){var k=this.getTabStateIfExists(j);k||h(0);return k;};i.prototype.getTabStateIfExists=function(j){return this.getTabs().find(function(k){return k.tabID===j;});};i.prototype.$ConversationNubTabStateList3=function(j){var k=this.$ConversationNubTabStateList5(this.$ConversationNubTabStateList1.getData()),l=this.$ConversationNubTabStateList2,m=this.$ConversationNubTabStateList5(j),n=c('differenceSets')(k,m,l),o=this.$ConversationNubTabStateList1.getData().filter(function(p){return n.has(p.tabID);});if(o.size)this.$ConversationNubTabStateList6(o);};i.prototype.$ConversationNubTabStateList6=function(j){j.forEach(function(k){c('ConversationNubUtils').informShouldCloseTab(k.tabID,k.ftID,c('ConversationNubUtils').CLOSE_REASON_SYNCHRONIZED_FROM_OTHER_TAB);});};i.prototype.$ConversationNubTabStateList4=function(j,k){var l=j.length!==0,m=this.$ConversationNubTabStateList2.size!==0;if(l||m)this.modifyTabs(function(n){var o=this.$ConversationNubTabStateList5(k),p=this.$ConversationNubTabStateList5(j),q=this.$ConversationNubTabStateList2,r=c('differenceSets')(o,p,q),s=k.filter(function(t){return r.has(t.tabID);});return j.concat(s);}.bind(this));};i.prototype.reloadFromStorageIfNecessary=function(){var j;(j=this.$ConversationNubTabStateList1).reloadFromStorageIfNecessary.apply(j,arguments);};i.serializeStateArrayToJson=function(j){var k=[];if(Array.isArray(j))k=j.map(i.serializeStateToJson).filter(Boolean);return k;};i.serializeStateToJson=function(j){var k=j.permalinkURI?j.permalinkURI.toString():null,l=babelHelpers['extends']({},j,{permalinkURI:k});return l;};i.deserializeJsonToStateArray=function(j){if(Array.isArray(j)){return j.map(i.deserializeJsonToState).filter(Boolean);}else return [];};i.deserializeJsonToState=function(j){if(j!=null&&typeof j.tabID==='string'&&typeof j.ftID==='string'&&typeof j.title==='string'&&typeof j.keepAtBottom==='boolean'&&typeof j.isTabRaised==='boolean'&&typeof j.isBlinkingUnread==='boolean'&&j.allSeenNewComments!=null&&j.allSeenNewComments instanceof Object&&j.unseenCommentsSinceLastCleared!=null&&j.unseenCommentsSinceLastCleared instanceof Object&&typeof j.hasFakeInitBadge==='boolean'&&typeof j.badgeCount==='number'&&(j.permalinkURI==null||typeof j.permalinkURI==='string')&&(j.notifAlertID==null||typeof j.notifAlertID==='string')&&(j.notificationType==null||typeof j.notificationType==='string')){var k=j.permalinkURI?new (c('URI'))(j.permalinkURI):null,l={tabID:j.tabID,ftID:j.ftID,notifAlertID:j.notifAlertID,notificationType:j.notificationType,title:j.title,keepAtBottom:j.keepAtBottom,isTabRaised:j.isTabRaised,isBlinkingUnread:j.isBlinkingUnread,allSeenNewComments:j.allSeenNewComments,unseenCommentsSinceLastCleared:j.unseenCommentsSinceLastCleared,hasFakeInitBadge:j.hasFakeInitBadge,badgeCount:j.badgeCount,permalinkURI:k};return l;}else return null;};i.prototype.push=function(){for(var j=arguments.length,k=Array(j),l=0;l<j;l++)k[l]=arguments[l];this.modifyTabs(function(m){k.forEach(function(n){if(m.find(function(o){return o.tabID===n.tabID;})){h(0);}else m.push(n);});return m;});};i.prototype.remove=function(j){this.modifyTabs(function(k){var l=k.findIndex(function(m){return m.tabID===j;});if(l!==-1)k.splice(l,1);return k;});};f.exports=i;}),null);
__d('ConversationNubTabsUpdateEventController',['Arbiter','ConversationNubUtils'],(function a(b,c,d,e,f,g){'use strict';var h='ConversationNub/tabsUpdated',i='ConversationNub/minimizedByUser',j='ConversationNub/maximizedByUser',k=false;function l(p){if(!k)c('Arbiter').inform(h,p);}function m(p){return c('Arbiter').subscribe(h,function(q,r){k=true;p(r);k=false;});}function n(p,q){q&&c('Arbiter').inform(i,{tab:p});p.minimize();l();}function o(p,q){if(!q&&!c('ConversationNubUtils').allowProgrammaticPopOut())return;q&&c('Arbiter').inform(j,{tab:p});p.popOut();l();}f.exports={TAB_MINIMIZED_BY_USER_EVENT:i,TAB_MAXIMIZED_BY_USER_EVENT:j,informTabsUpdated:l,subscribeToTabsUpdated:m,minimizeAndInformTabUpdate:n,popOutAndInformTabUpdate:o};}),null);
__d("XConversationNubTogglePinController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/ajax\/conversation\/nub_story\/toggle_pin\/",{ft_id:{type:"String"},pin:{type:"Bool",defaultValue:false},with_render:{type:"Bool",defaultValue:false},notif_setting:{type:"Enum",enumType:1},tab_size:{type:"Enum",defaultValue:1,enumType:0}});}),null);
__d("XConversationsToggleController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/ajax\/conversation\/toggle_feature\/",{turn_conversations_on:{type:"Bool",defaultValue:false}});}),null);
__d('isBusinessURI',['isFacebookURI'],(function a(b,c,d,e,f,g){'use strict';function h(i){return c('isFacebookURI')(i)&&i.getSubdomain()==='business';}f.exports=h;}),null);
__d('ConversationNubUtils',['csx','Arbiter','AsyncFeature','AsyncRequest','DOM','Event','EventListener','Keys','NotificationConversationController','URI','XConversationNubTogglePinController','XConversationsToggleController','ConversationNubTabState','isBusinessURI','isCanvasAppURI'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('ConversationNubTabState'),j={DISABLE:'disable',ENABLE:'enable'},k='ConversationNubUtils/closeTab',l='ConversationNubUtils/unpinnedFromHeader',m='ConversationNubUtils/recheckTabVisibility',n='ConversationNubUtils/openPermalinkFromHeader',o='ConversationNubUtils/turnOff',p='ConversationNubUtils/turnOn',q='tab-x-out',r='browser-tab-sync',s='overflow-x-out',t='unpin';function u(oa){var pa=Object.values(j);return pa.find(function(qa){return qa===oa;})||null;}function v(oa,pa,qa,ra){var sa=ra||{},ta=sa.notif_setting,ua=c('XConversationNubTogglePinController').getURIBuilder().setString('ft_id',String(oa)).setBool('pin',pa);if(ta&&c('AsyncFeature').__serverHasFeatureImpl(3))ua.setEnum('notif_setting',ta);var va=ua.getURI(),wa=new (c('AsyncRequest'))().setURI(va).setMethod('POST');if(qa)wa.setAllowCrossPageTransition(true);wa.send();}function w(oa){var pa=c('XConversationsToggleController').getURIBuilder().setBool('turn_conversations_on',oa).getURI();oa?na():ma();var qa=new (c('AsyncRequest'))().setURI(pa).setAllowCrossPageTransition(true).setHandler(function(ra){if(ra.getPayload().conversationsStatus){na();}else ma();}).setErrorHandler(function(ra){oa?ma():na();}).setMethod('POST');qa.send();}function x(oa,pa,qa){v(oa,true,pa,qa);}function y(oa,pa,qa){v(oa,false,pa,qa);}function z(oa,pa){x(oa,false,pa);}function aa(oa,pa){y(oa,false,pa);}function ba(oa,pa){x(oa,true,pa);}function ca(oa,pa){y(oa,true,pa);}function da(){w(false);c('NotificationConversationController').deleteAllTabs();}function ea(){w(true);}function fa(oa){return c('DOM').scry(oa,"._4iz6")[0];}function ga(oa,pa,qa){var ra=function sa(){qa();};pa.addSubscriptions(c('EventListener').listen(oa,'click',ra),c('EventListener').listen(oa,'keydown',function(sa){if(c('Event').getKeyCode(sa)===c('Keys').RETURN)ra();}));}function ha(){var oa=c('URI').getRequestURI();return !c('isCanvasAppURI')(oa)&&!c('isBusinessURI')(oa);}function ia(oa,pa,qa){var ra=i.getLoadedTab(oa);if(!ra)return;var sa=ra.getPersistentState(),ta=ra.getSessionID();c('Arbiter').inform(k,{tabID:oa,ftID:pa,tabState:sa,sessionID:ta,reason:qa});}function ja(oa){var pa=i.getLoadedTab(oa);if(!pa)return;c('Arbiter').inform(l,{tab:pa});}function ka(oa){c('Arbiter').inform(m,{tab:oa});}function la(oa){var pa=i.getLoadedTab(oa);if(!pa)return;c('Arbiter').inform(n,{tab:pa});}function ma(){c('Arbiter').inform(o,{});}function na(){c('Arbiter').inform(p,{});}f.exports={CLOSE_TAB_EVENT:k,UNPIN_FROM_HEADER_EVENT:l,OPEN_PERMALINK_FROM_HEADER_EVENT:n,TURN_CONVERSATIONS_OFF_EVENT:o,TURN_CONVERSATIONS_ON_EVENT:p,CLOSE_REASON_TAB_X_OUT:q,CLOSE_REASON_SYNCHRONIZED_FROM_OTHER_TAB:r,CLOSE_REASON_OVERFLOW_X_OUT:s,CLOSE_REASON_UNPIN:t,coerceToPinRequestNotifSetting:u,sendPinRequest:z,sendUnpinRequest:aa,sendPinRequestAcrossTransitions:ba,sendUnpinRequestAcrossTransitions:ca,getCloseButtonElem:fa,addCloseButtonListeners:ga,informShouldCloseTab:ia,informDidUnpinFromHeaderMenu:ja,informShouldRecheckTabVisibility:ka,informOpenPermalinkFromHeader:la,allowProgrammaticPopOut:ha,turnConversationsOff:da,turnConversationsOn:ea};}),null);
__d('ConversationNubPermalinkUtils',['URI','isFacebookURI'],(function a(b,c,d,e,f,g){'use strict';function h(l){return l.substr(-1)==='/'?l.slice(0,-1):l;}function i(l,m){var n=l.getPath(),o=m.getPath();return h(n)===h(o);}function j(l,m,n){var o=l.getQueryData(),p=m.getQueryData(),q=o[n],r=p[n];if(q==null&&r==null)return true;return q===r;}function k(l){var m=new (c('URI'))(window.location.href);return (m&&l&&c('isFacebookURI')(m)&&c('isFacebookURI')(l)&&i(m,l)&&j(m,l,'fbid')&&j(m,l,'story_fbid'));}f.exports={isOnPermalink:k};}),null);
__d('ConversationNubViewportManager',['DockTabsViewportCalculator','DockTabsViewportPinnedConversationTabUtils'],(function a(b,c,d,e,f,g){'use strict';var h=c('DockTabsViewportPinnedConversationTabUtils').getMinRequiredWidthForFirstConvoTab;function i(j,k,l){this.$ConversationNubViewportManager1=j;this.$ConversationNubViewportManager3=k;this.$ConversationNubViewportManager2=c('DockTabsViewportCalculator').getInstance(this.$ConversationNubViewportManager1);this.$ConversationNubViewportManager2&&this.$ConversationNubViewportManager2.registerPinnedConvoTabCallbacks(babelHelpers['extends']({},l,{pinnedConvoTabStateGetter:function(){return this.$ConversationNubViewportManager3;}.bind(this)}));}i.prototype.getNumDockTabsToShow=function(j){return this.getCouldFitAtLeastOneDockTab(j)?1:0;};i.prototype.getCouldFitAtLeastOneDockTab=function(j){var k=h();return k<=j;};i.prototype.forceRecalculatePinnedConvoTabs=function(j){this.$ConversationNubViewportManager2&&this.$ConversationNubViewportManager2.forceRecalculatePinnedConvoTabs(j);};f.exports=i;}),null);
__d('ConversationNubVisibilityDedupeUtils',['Bootloader','emptyFunction','ifRequired'],(function a(b,c,d,e,f,g){'use strict';function h(j){c('Bootloader').loadModules(["UFICommentVisibilityStore"],j,'ConversationNubVisibilityDedupeUtils');}function i(j){return c('ifRequired')('UFICommentVisibilityStore',function(k){return (k.isFeedbackTargetVisible(j));},c('emptyFunction').thatReturnsFalse);}f.exports={bootloadUFIVisibilityModule:h,isFeedbackTargetVisible:i};}),null);
__d("XNotificationNubStoryController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/conversation\/nub_story\/",{notif_alert_id:{type:"String"},notif_id:{type:"Int"},ft_id:{type:"String"},force_minimized:{type:"Bool",defaultValue:false},tab_size:{type:"Enum",defaultValue:1,enumType:0}});}),null);
__d('NotificationConversationController',['csx','cx','Arbiter','AsyncRequest','Bootloader','CSS','ConversationNub','ConversationNubActionTakenReporter','ConversationNubAddTabSource','ConversationNubPermalinkUtils','ConversationNubTabState','ConversationNubTabsUpdateEventController','ConversationNubUtils','ConversationNubViewportManager','ConversationNubVisibilityDedupeUtils','DOM','PinnedConversationNubsConfig','SubscriptionsHandler','URI','XNotificationNubStoryController','ge','ifRequired'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=c('ConversationNubVisibilityDedupeUtils').isFeedbackTargetVisible,k=1,l=c('ConversationNubTabState'),m=Object.create(null),n=null,o=null,p=null,q=null,r=null,s=null,t=false,u=null,v=null,w=null,x=null,y=Object.create(null);function z(){if(!o)o=c('DOM').scry(c('ge')('pagelet_dock'),"._1mw-")[0];return o;}function aa(){if(!p){var da=z();if(da)p=c('DOM').scry(da,"._1tvj")[0];}return p;}function ba(){if(!q){var da=z();if(da)q=c('DOM').scry(da,"._2ikx .fbNubButton")[0];}return q;}ca.prototype.init=function(){if(t)return;t=true;var da=new (c('SubscriptionsHandler'))();da.addSubscriptions(c('ConversationNubTabsUpdateEventController').subscribeToTabsUpdated(this.$NotificationConversationController2.bind(this)),c('Arbiter').subscribe(c('ConversationNubUtils').CLOSE_TAB_EVENT,function(ea,fa){var ga=fa||{},ha=ga.tabID;if(ha)this.$NotificationConversationController3(ha);}.bind(this)));this.$NotificationConversationController1=new (c('ConversationNubActionTakenReporter'))();u=da;};ca.prototype.handleAllEndpointNotifications=function(da){this.init();var ea=da.filter(function(fa){return fa.seen_state==='UNSEEN_AND_UNREAD';});this.handleNewNotifications(ea,c('ConversationNubAddTabSource').UNSEEN_NOTIFICATION);};ca.prototype.$NotificationConversationController4=function(da){var ea=n?n.getNumDockTabsToShow(da):k;l.setMaxDockTabs(ea);};ca.prototype.$NotificationConversationController5=function(da,ea){this.$NotificationConversationController4(da);if(ea){var fa=ea.tabToPromote,ga=ea.tabToOpenIfInDock;if(fa&&!l.isTabInDock(fa.getTabID()))l.moveTabToDockLeft(fa.getTabID());if(c('ConversationNubUtils').allowProgrammaticPopOut()&&ga&&l.isTabInDock(ga.getTabID()))ga.popOut();}this.$NotificationConversationController6(da);};ca.prototype.$NotificationConversationController2=function(da){n&&n.forceRecalculatePinnedConvoTabs(da);};ca.prototype.$NotificationConversationController6=function(da){var ea=l.getTotalTabCount(),fa=l.getNumDockTabs(),ga=n&&n.getCouldFitAtLeastOneDockTab(da),ha=ea>0&&ga,ia=fa<ea&&ha,ja=z();if(ja){c('CSS').conditionClass(ja,"_1tvf",ha);c('CSS').conditionClass(ja,"_1dex",ia);c('CSS').conditionClass(ja,"_1tvi",ia);}var ka=c('PinnedConversationNubsConfig').pinnedToLeft?l.getTabsForDockOldestFirst():l.getTabsForDockNewestFirst();ka.forEach(function(ma){if(ma.getIsRaised())ma.clearBadge();});var la=l.getTabsForMenuNewestFirst();this.$NotificationConversationController7(ka);this.$NotificationConversationController8(la);};ca.prototype.handleNotificationsRead=function(da){this.init();l.getUnsortedLoadedTabs().forEach(function(fa){var ga=fa.getNotificationAlertID();if(da[ga])fa.clearBadge();});l.getUnloadedTabs().forEach(function(fa){if(da[fa.notifAlertID])l.clearTabNotifications(fa.tabID);});var ea=l.getTabsForMenuNewestFirst();this.$NotificationConversationController8(ea);};ca.prototype.handleNewNotifications=function(da,ea){this.init();da.forEach(function(fa){var ga=fa.alert_id,ha=fa.pinnedConvoConfig,ia=fa.tracking,ja=fa.notif_type;if(!ha)return;var ka=ha.tab_id,la=ha.ft_id,ma=ha.permalink_uri,na=JSON.parse(ia),oa=ma?new (c('URI'))(ma):null;this.$NotificationConversationController9(ka,na.alert_id,la,ga,oa,ea,ja);}.bind(this));};ca.prototype.$NotificationConversationController9=function(da,ea,fa,ga,ha,ia,ja){var ka=c('XNotificationNubStoryController').getURIBuilder().setString('notif_alert_id',ga).setInt('notif_id',ea);this.$NotificationConversationController10(fa,ia);this.$NotificationConversationController11(da,fa,ja,ha,ka);};ca.prototype.$NotificationConversationController10=function(da,ea){if(!y[da])y[da]=ea;};ca.prototype.requestPersistedStory=function(da,ea,fa,ga){this.$NotificationConversationController10(ea,ga);var ha=c('XNotificationNubStoryController').getURIBuilder().setString('ft_id',ea);this.$NotificationConversationController11(da,ea,null,fa,ha);};ca.prototype.$NotificationConversationController11=function(da,ea,fa,ga,ha){if(m[da])return;var ia=l.getLoadedTab(da);if(ia){if(fa)ia.setNotificationType(fa);return;}if(c('ConversationNubPermalinkUtils').isOnPermalink(ga)||j(ea))ha.setBool('force_minimized',true);m[da]=true;new (c('AsyncRequest'))().setURI(ha.getURI()).setAllowCrossPageTransition(true).setFinallyHandler(function(){delete m[da];}).send();};ca.prototype.$NotificationConversationController12=function(da){var ea=true;l.getUnsortedLoadedTabs().forEach(function(fa){var ga=fa.getFeedbackTargetID(),ha=da[ga],ia=ha?Object.keys(ha):[];if(ia.length){var ja=fa.getBadgeCount();if(j(ga)){fa.markCommentsAsSeenWithoutBadging(ia);fa.clearBadge();}else fa.attemptAddNewCommentsToBadge(ia);var ka=fa.getBadgeCount();if(ja!==ka)ea=true;}});if(ea)c('ConversationNubTabsUpdateEventController').informTabsUpdated();};ca.prototype.$NotificationConversationController13=function(da){if(x)return;c('Bootloader').loadModules(["ConversationNubSurveys"],function(ea){if(!x)x=new ea(da);},'NotificationConversationController');};ca.prototype.$NotificationConversationController14=function(da,ea,fa){if(w){w.addTab(da,fa);delete y[da.getPersistentState().ftID];return;}c('Bootloader').loadModules(["ConversationNubLogger"],function(ga){if(!w)w=new ga(ea);w.addTab(da,fa);delete y[da.getPersistentState().ftID];},'NotificationConversationController');};ca.prototype.$NotificationConversationController15=function(){if(v)return;c('Bootloader').loadModules(["ConversationNubUFICentralUpdateManager"],function(da){if(v)return;v=new da(this.$NotificationConversationController12.bind(this));}.bind(this),'NotificationConversationController');};ca.prototype.$NotificationConversationController7=function(da){var ea=aa();if(!ea)return;c('Bootloader').loadModules(["React","ReactDOM","ConversationNubDockedTabGroup.react"],function(fa,ga,ha){s=ga.render(fa.createElement(ha,{dockTabs:da}),ea);},'NotificationConversationController');};ca.prototype.$NotificationConversationController16=function(da){da.popOut();c('ConversationNubTabsUpdateEventController').informTabsUpdated({tabToPromote:da});};ca.prototype.$NotificationConversationController8=function(da){var ea=ba();if(!ea)return;c('Bootloader').loadModules(["React","ReactDOM","ConversationNubCollapsedSelectorMenu.react"],function(fa,ga,ha){r=ga.render(fa.createElement(ha,{menuTabs:da,onTabSelected:this.$NotificationConversationController16}),ea);}.bind(this),'NotificationConversationController');};ca.prototype.$NotificationConversationController17=function(){if(!n){var da=z();if(da){var ea={onAvailableWidthChanged:this.$NotificationConversationController5.bind(this)};n=new (c('ConversationNubViewportManager'))(da,l,ea);}}};ca.prototype.storyFromServer=function(da,ea){if(!t)this.init();var fa=ea.attempt_open_on_init,ga=ea.ft_id,ha=ea.init_without_badge,ia=ea.notif_alert_id,ja=ea.notification_type,ka=ea.permalink_uri,la=ea.promote_on_init,ma=ea.tab_add_source,na=ea.tab_id,oa=ea.title,pa=ea.should_show_intro_nux,qa=ea.should_show_hide_nux,ra=l.getLoadedTab(na);if(ra){if(la||fa)c('ConversationNubTabsUpdateEventController').informTabsUpdated({tabToPromote:la?ra:null,tabToOpenIfInDock:fa?ra:null});return;}ha=ha||j(ga);var sa=l.getTabStateIfExists(na);if(sa){ha=null;}else{var ta=c('ConversationNub').createDefaultState(na,ka,ga,ia,ja,oa);l.addTabState(ta);}var ua=new (c('ConversationNub'))(da,na,ha,Boolean(pa),Boolean(qa));l.addLoadedTab(na,ua);fa=fa||ua.getPersistentState().isTabRaised;this.$NotificationConversationController15();this.$NotificationConversationController17();c('ConversationNubTabsUpdateEventController').informTabsUpdated({tabToPromote:la?ua:null,tabToOpenIfInDock:fa?ua:null});this.$NotificationConversationController13(l);var va=y[ga]||ma||'unknown';this.$NotificationConversationController14(ua,l,va);};ca.prototype.deleteAllTabs=function(){l.deleteAllTabs();c('ConversationNubTabsUpdateEventController').informTabsUpdated();};ca.prototype.$NotificationConversationController3=function(da){var ea=l.deleteTab(da);if(ea)c('ConversationNubTabsUpdateEventController').informTabsUpdated();};ca.prototype.unsubscribe=function(){u&&u.release();u=null;w&&w.destroy();w=null;x&&x.destroy();x=null;v&&v.destroy();v=null;this.$NotificationConversationController1.destroy();c('ifRequired')('ReactDOM',function(da){var ea=ba();if(r&&ea)da.unmountComponentAtNode(ea);var fa=aa();if(s&&fa)da.unmountComponentAtNode(fa);});};function ca(){}f.exports=new ca();}),null);
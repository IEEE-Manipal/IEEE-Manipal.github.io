if (self.CavalryLogger) { CavalryLogger.start_js(["mKzeF"]); }

__d('PageLiveInsightsItemContents.react',['BootloadOnRender.react','JSResource','LazyComponent.react','React'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('React').Component);i=h&&h.prototype;j.prototype.render=function(){return (c('React').createElement(c('BootloadOnRender.react'),{loader:c('JSResource')('PageLiveInsightsItemContentsImpl.react').__setRef('PageLiveInsightsItemContents.react'),placeholder:c('React').createElement('div',null),component:c('React').createElement(c('LazyComponent.react'),babelHelpers['extends']({},this.props,{ref:'itemContents'}))}));};function j(){h.apply(this,arguments);}f.exports=j;}),null);
__d("XPymkFunnelLoggingController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/pymk\/funnel_logging\/",{event_ts:{type:"Int",required:true},query_id:{type:"Int"},candidate_id:{type:"Int"},signature:{type:"Int"},loc:{type:"String",required:true},ref:{type:"String"},action:{type:"Enum",required:true,enumType:1}});}),null);
__d('PymkFunnelLogger',['AsyncRequest','DOMQuery','XPymkFunnelLoggingController'],(function a(b,c,d,e,f,g){var h={setupListeners:function i(j,k,l,m,n){this._setupForSingleElement(j,k,l,'add');this._setupForSingleElement(j,k,m,'click');this._setupForSingleElement(j,k,n,'click');},logImpression:function i(j,k,l){this._logEvent(j,'impression',k,l);},logXOut:function i(j,k,l){this._logEvent(j,'hide',k,l);},_logEvent:function i(j,event,k,l){var m=c('XPymkFunnelLoggingController').getURIBuilder().setInt('candidate_id',j).setInt('signature',k).setInt('event_ts',Math.floor(Date.now()/1000)).setEnum('action',event).setString('loc',l).getURI();new (c('AsyncRequest'))(m).setMethod('POST').send();},_setupForSingleElement:function i(j,k,l,m){Event.listen(l,'click',function(event){var n=j.getAttribute('data-signature'),o=c('DOMQuery').find(j,'input.friendBrowserID'),p=parseInt(o.value,10);this._logEvent(p,m,n,k);}.bind(this));}};f.exports=h;}),null);
__d("XFriendRequestIHEventLoggingController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/requests\/interaction_history_logging\/",{target_id:{type:"FBID",required:true},log_event:{type:"String",required:true}});}),null);
__d('FriendRequestIHEventLogger',['Event','AsyncRequest','XFriendRequestIHEventLoggingController'],(function a(b,c,d,e,f,g){var h={setupJewelListeners:function i(j,k,l){this._setupForJewelSingleElement(j,k,'click');if(l)this._setupForJewelSingleElement(j,l,'click');},logImpression:function i(j){this._logEvent(j,'impression');},_logEvent:function i(j,event){if(isNaN(j))return;var k=c('XFriendRequestIHEventLoggingController').getURIBuilder().setFBID('target_id',j).setString('log_event',event).getURI();new (c('AsyncRequest'))(k).setMethod('POST').send();},_setupForJewelSingleElement:function i(j,k,l){c('Event').listen(k,'click',function(event){var m=j.getAttribute('id');if(!m)return;var n=m.substring(0,m.length-6);this._logEvent(n,l);}.bind(this));}};f.exports=h;}),null);
__d('QPRenderer',['$','CSS','XAsyncRequest','XQuickPromotionSimpleLoggingController'],(function a(b,c,d,e,f,g){var h=function m(n,event,o){var p=c('XQuickPromotionSimpleLoggingController').getURIBuilder().setInt('qp_id',n).setString('qp_event',event).setStringToStringMap('qp_instance_log_data',o).getURI();new (c('XAsyncRequest'))(p).send();},i=function m(n,o,p){var q=c('XQuickPromotionSimpleLoggingController').getURIBuilder().setInt('qp_id',n).setEnum('qp_action',o).setStringToStringMap('qp_instance_log_data',p).getURI();new (c('XAsyncRequest'))(q).send();},j=function m(n,o,p,q,r,s){l(n,p,c('$')(q),s,function(){if(r)c('CSS').hide(o);});},k=function m(n,o,p){o.show();h(n,'view',{});o.subscribe('cancel',function(){h(n,'dialog_cancel',{});});for(var q=0;q<p.length;q++){var r=p[q],s=c('$')(r.element_id);l(n,r.action,s,r.instance_log_data,r.should_close?function(){o.hide();}:function(){});if(r.action=='primary')s.focus();}},l=function m(n,o,p,q,r){p.addEventListener('click',function(){var s=c('XQuickPromotionSimpleLoggingController').getURIBuilder().setInt('qp_id',n).setEnum('qp_action',o).setStringToStringMap('qp_instance_log_data',q).getURI();new (c('XAsyncRequest'))(s).send();r();});};g.setAction=j;g.setDialogActionsAndShow=k;g.logAction=i;g.logEvent=h;}),null);
__d('JewelQPLogging',['QPRenderer'],(function a(b,c,d,e,f,g){var h=false,i=null,j=false;function k(){if(j)return;if(h&&i){j=true;c('QPRenderer').logEvent(i.promotion_id,'view',i.instance_log_data?i.instance_log_data:{});}}var l={onJewelOpened:function m(){h=true;k();},updateQPLogData:function m(n){i=n;k();}};f.exports=l;}),null);
__d('RequestsJewelStore',['Arbiter','ArbiterMixin','ChannelConstants'],(function a(b,c,d,e,f,g){var h=babelHelpers['extends']({},c('ArbiterMixin'),{_initialized:false,_count:0,_requestList:{},addFriendRequests:function i(j){Object.assign(this._requestList,j);},getRequestListKeys:function i(){return Object.keys(this._requestList);},removeRequest:function i(j){delete this._requestList[j];},getRequestCount:function i(j){return this.getRequestListKeys().length;},decrementCount:function i(){this.setCount(Math.max(0,this._count-1));},setCount:function i(j){c('Arbiter').inform('jewel/count-updated',{jewel:'requests',count:j},c('Arbiter').BEHAVIOR_STATE);},setupListeners:function i(){if(this._initialized)return;this._initialized=true;c('Arbiter').subscribe('jewel/count-updated',function(j,k){k.jewel==='requests'&&this._updateCount(k.count);}.bind(this));c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('jewel_requests_add'),function(j,k){return this._addRequest(k);}.bind(this));c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('jewel_friending_notifs'),function(j,k){return this._addNotification(k);}.bind(this));c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('jewel_requests_remove_old'),function(j,k){return this._removeOldRequest(k);}.bind(this));c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('friend_requests_seen'),function(j,k){return this.setCount(0);}.bind(this));},_updateCount:function i(j){var k=this._count!==j;this._count=j;if(k)this.inform('countUpdated',j);},_addRequest:function i(j){if(!j)return;var k=j.obj,l=k.from,m=k.suggester,n=this._requestList[l];if(!n)this.setCount(this._count+1);var o=n?n.type:null,p=o===19&&!m;this.inform('addRequest',{shouldReplace:p,previousType:o});},_addNotification:function i(j){if(!j||j.obj.notif_type!=='friend_confirmed')return;this.inform('addNotification');},_removeOldRequest:function i(j){if(!j)return;var k=this._requestList[j.obj.from];if(!k)return;this.inform('removeOldRequest',k);}});f.exports=h;}),null);
__d('RequestsJewelController',['invariant','Promise','Arbiter','AsyncRequest','AsyncSignal','CSS','DOM','DOMQuery','Event','FriendRequestIHEventLogger','JewelQPLogging','MarauderLogger','Parent','PymkFunnelLogger','RequestsJewelStore','ScrollableArea','ge','getElementPosition','getViewportDimensions','requireWeak','throttle'],(function a(b,c,d,e,f,g,h){var i=null;c('requireWeak')('FriendBrowserCheckboxController',function(o){return i=o;});var j=31,k=600,l=30,m=160;n.getInstance=function(){'use strict';return this.$RequestsJewelController11;};n.updateFromDOM=function(){'use strict';var o=this.getInstance();if(o)o.fromDom();};n.setupScroll=function(){'use strict';var o=this.getInstance();if(o)o.setupScroll();};n.setInitialHeight=function(){'use strict';var o=this.getInstance();if(o)o.updateHeight();};n.maybeLoadJewel=function(){'use strict';var o=this.getInstance();if(o)o.maybeLoadJewel();};n.isOpen=function(){'use strict';var o=this.getInstance();if(o)return o.$RequestsJewelController3();return false;};n.create=function(o,p,q){'use strict';!this.$RequestsJewelController11||h(0);return this.$RequestsJewelController11=new n(o,p,q);};function n(o,p,q){'use strict';this.$RequestsJewelController3=p;this.$RequestsJewelController2=q;this.$RequestsJewelController1=o;this.$RequestsJewelController5=-1;this.$RequestsJewelController6=-1;this.$RequestsJewelController10=c('Promise').resolve(true);this.$RequestsJewelController8=c('throttle').acrossTransitionsWithBlocking(function(){return this.$RequestsJewelController12({log_impressions:true});}.bind(this),5000);c('RequestsJewelStore').subscribe('addRequest',this.$RequestsJewelController13.bind(this));c('RequestsJewelStore').subscribe('addNotification',function(){return this.$RequestsJewelController14();}.bind(this));c('RequestsJewelStore').subscribe('removeOldRequest',this.$RequestsJewelController15.bind(this));c('RequestsJewelStore').setupListeners();this.setupScroll();this.$RequestsJewelController16();this.$RequestsJewelController17();this.$RequestsJewelController18();}n.prototype.fromDom=function(){'use strict';var o={};c('DOMQuery').scry(this.$RequestsJewelController1,'li.objectListItem').forEach(function(p){var q=p.getAttribute('id');if(q){var r=this.$RequestsJewelController19(q);if(r&&r.requester)o[r.requester]=r;}}.bind(this));c('RequestsJewelStore').addFriendRequests(o);this.$RequestsJewelController20();};n.prototype.maybeLoadJewel=function(){'use strict';if(this.$RequestsJewelController9){this.$RequestsJewelController9=false;this.openHandler();}};n.prototype.updateHeight=function(){'use strict';var o=this.$RequestsJewelController21();if(o)o.style.height=this.$RequestsJewelController22()+'px';};n.prototype.markSeen=function(){'use strict';this.$RequestsJewelController10.done(function(){var o=c('DOMQuery').scry(this.$RequestsJewelController1,'li[id]')[0];new (c('AsyncSignal'))('/ajax/gigaboxx/endpoint/UpdateLastSeenTime.php',{folder:this.$RequestsJewelController2,first_item:o.getAttribute('id')}).send();}.bind(this));};n.prototype.openHandler=function(){'use strict';c('Arbiter').inform('requestsJewel/opened');var o=c('ge')('fbRequestsJewelLoading'),p=this.$RequestsJewelController21();if(!o&&!p){this.$RequestsJewelController9=true;}else if(o){this.$RequestsJewelController8();}else{var q=c('RequestsJewelStore').getRequestListKeys();if(q.length>0)new (c('AsyncRequest'))().setAllowCrossPageTransition(true).setURI('/friends/requests/log_impressions').setData({ids:q.join(','),ref:'jewel'}).send();}p&&c('ScrollableArea').poke(p);c('JewelQPLogging').onJewelOpened();};n.prototype.closeHandler=function(){'use strict';c('Arbiter').inform('requestsJewel/closed');c('DOMQuery').scry(this.$RequestsJewelController1,'li.jewelItemNew').forEach(function(o){c('CSS').removeClass(o,'jewelItemNew');});};n.prototype.setupScroll=function(){'use strict';var o=this.$RequestsJewelController21();if(o){this.$RequestsJewelController7=this.$RequestsJewelController23();this.$RequestsJewelController4=0;c('ScrollableArea').getInstance(o).subscribe('scroll',this.$RequestsJewelController24.bind(this));this.$RequestsJewelController25();this.$RequestsJewelController26();}};n.prototype.$RequestsJewelController16=function(){'use strict';c('Event').listen(this.$RequestsJewelController1,'submit',function(o){var p=c('Parent').byClass(o.getTarget(),'objectListItem');if(p){c('CSS').removeClass(p,'jewelItemNew');c('CSS').addClass(p,'jewelItemResponded');}});};n.prototype.$RequestsJewelController17=function(){'use strict';c('Event').listen(window,'resize',c('throttle').acrossTransitions(function(){this.updateHeight();}.bind(this)));};n.prototype.$RequestsJewelController18=function(){'use strict';c('Arbiter').subscribe('pymk-x-out',function(o,p){var q=p.location;if(q==='pymk_jewel_first_page'||q==='pymk_jewel')this.$RequestsJewelController25();}.bind(this));};n.prototype.$RequestsJewelController27=function(o){'use strict';var p=parseInt(o,10);return !isNaN(p)?p:null;};n.prototype.$RequestsJewelController19=function(o){'use strict';var p=o.match(/^(\d+)_(\d+)/);if(!p)return null;return {requester:this.$RequestsJewelController27(p[1]),type:this.$RequestsJewelController27(p[2])};};n.prototype.$RequestsJewelController28=function(o,p){'use strict';if(o==null||p==null)return null;return o+'_'+p;};n.prototype.$RequestsJewelController21=function(){'use strict';return c('DOMQuery').scry(this.$RequestsJewelController1,'.uiScrollableArea')[0];};n.prototype.$RequestsJewelController23=function(){'use strict';return c('DOMQuery').scry(this.$RequestsJewelController1,'.uiScrollableAreaWrap')[0];};n.prototype.$RequestsJewelController24=function(){'use strict';var o=c('DOMQuery').scry(this.$RequestsJewelController7,'.uiMorePager').pop();if(o){var p=c('getElementPosition')(o).y;if(p>0)c('CSS').addClass(this.$RequestsJewelController21(),'contentAfter');var q=c('DOMQuery').find(o,'a');if(!q)return;var r=c('getElementPosition')(q).y;if(r===this.$RequestsJewelController4)return;var s=c('getElementPosition')(this.$RequestsJewelController7),t=s.y+s.height;if(r-300<t&&r>0){this.$RequestsJewelController4=r;var u=q.getAttribute('ajaxify');if(u){new (c('AsyncRequest'))(u).setRelativeTo(q).setStatusElement(c('Parent').byClass(q,'stat_elem')).send();}else if(i)i.getInstance('jewel').showMore();}}this.$RequestsJewelController25();this.$RequestsJewelController26();};n.prototype.$RequestsJewelController25=function(){'use strict';if(!this.$RequestsJewelController7)return;var o=c('getElementPosition')(this.$RequestsJewelController7),p=o.y+o.height,q=c('DOMQuery').scry(this.$RequestsJewelController1,'li.friendBrowserListUnit'),r=q.length-1;while(r>this.$RequestsJewelController5){var s=c('getElementPosition')(q[r]),t=s.y,u=t+s.height;if(t>0&&u<=p)break;r-=1;}var v=r;while(r>this.$RequestsJewelController5){var w=c('DOMQuery').find(q[r],'input.friendBrowserID'),x=parseInt(w.value,10),y=parseInt(q[r].getAttribute('data-signature'),10);c('PymkFunnelLogger').logImpression(x,y,'pymk_jewel');r--;}this.$RequestsJewelController5=Math.max(this.$RequestsJewelController5,v);};n.prototype.$RequestsJewelController26=function(){'use strict';if(!this.$RequestsJewelController7)return;var o=c('getElementPosition')(this.$RequestsJewelController7),p=o.y+o.height,q=c('DOMQuery').scry(this.$RequestsJewelController1,'li.objectListItem'),r=q.length-1;while(r>this.$RequestsJewelController6){var s=c('getElementPosition')(q[r]),t=s.y,u=t+s.height;if(t>0&&u<=p)break;r-=1;}var v=r;while(r>this.$RequestsJewelController6){var w=q[r].getAttribute('id');w=w.substring(0,w.length-6);c('MarauderLogger').log('request_seen','friend_request_waterfall',{request_id:w,request_location:'requests_jewel'});c('FriendRequestIHEventLogger').logImpression(w);r-=1;}this.$RequestsJewelController6=Math.max(this.$RequestsJewelController6,v);};n.prototype.$RequestsJewelController12=function(){var o=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];'use strict';this.$RequestsJewelController10=new (c('Promise'))(function(p,q){var r=!c('ge')('fbRequestsJewelLoading');new (c('AsyncRequest'))().setURI('/ajax/requests/loader/').setData(babelHelpers['extends']({},o,{reloadcontent:r})).setFinallyHandler(function(s){if(!s.getError()){p(true);}else q();}).send();});};n.prototype.$RequestsJewelController14=function(){'use strict';if(this.$RequestsJewelController3())return;this.$RequestsJewelController12();};n.prototype.$RequestsJewelController13=function(o,p){var q=p.shouldReplace,r=p.previousType;'use strict';if(!q&&(r||this.$RequestsJewelController3()))return;this.$RequestsJewelController12();};n.prototype.$RequestsJewelController15=function(o,p){var q=p.requester,r=p.type;'use strict';if(this.$RequestsJewelController3()||c('ge')('fbRequestsJewelLoading')!=null)return;var s=this.$RequestsJewelController28(q,r),t=s&&c('ge')(s);if(t){if(c('CSS').hasClass(t,'jewelItemNew'))c('RequestsJewelStore').decrementCount();if(!c('CSS').hasClass(t,'jewelItemResponded')){c('DOM').remove(t);c('RequestsJewelStore').removeRequest(q);this.$RequestsJewelController20();}}};n.prototype.$RequestsJewelController20=function(){'use strict';c('DOMQuery').scry(this.$RequestsJewelController1,'li.empty').forEach(function(o){c('CSS').conditionShow(o,c('RequestsJewelStore').getRequestCount()<=0);});};n.prototype.$RequestsJewelController22=function(){'use strict';return Math.min(Math.max(c('getViewportDimensions')().height-m,l),k)+j;};n.$RequestsJewelController11=null;f.exports=n;}),null);
__d('FBRTCStruct',[],(function a(b,c,d,e,f,g){var h=function j(k,l,m){var n,o;if(typeof k=='string'||k instanceof String){o=k;n=k;}else for(var p in k)if(Object.prototype.hasOwnProperty.call(k,p))if(p==='index'){m=k[p];}else{o=p;n=k[p];}l[o]=m;l.strNames[m]=n;};function i(j){'use strict';this.strNames=[];for(var k=0;k<j.length;k++)h(j[k],this,k);}f.exports=i;}),null);
__d('FBRTCConstants',['FBRTCStruct','keyMirror'],(function a(b,c,d,e,f,g){var h={OFFER:'offer',ANSWER:'answer',ICE_CANDIDATE:'ice_candidate',OK:'ok',PING:'ping',PING_ACK:'ping_ack',HANGUP:'hang_up',OTHER_DISMISS:'other_dismiss',MSG_ACK:'msg_ack',PRANSWER:'pranswer',ICERESTART_OFFER:'icerestart_offer',ICERESTART_ANSWER:'icerestart_answer',PCRESTART_OFFER:'pcrestart_offer',PCRESTART_ANSWER:'pcrestart_answer',SDP_UPDATE:'sdp_update',OFFER_ACK:'offer_ack',OFFER_NACK:'offer_nack',ANSWER_ACK:'answer_ack',SET_VIDEO:'set_video',VIDEO_REQUEST:'video_request',ACK:'ack'},i={CHILD_WINDOW_READY:'rtc_child_window_ready',CHILD_WINDOW_START_CALL:'rtc_child_window_start_call',CHILD_WINDOW_MESSAGE:'rtc_child_window_message'},j={LL_NONE:0,LL_BASIC:1,LL_DEBUG:2,LL_WARNING:3,LL_INFO:4,LL_VERBOSE:5},k={AUDIO_ONLY:'audio_only',AUDIO_VIDEO:'audio_video',SCREEN_CONTENT:'screen'},l=c('keyMirror')({NO_VIDEO:null,LQ_VIDEO:null,SD_VIDEO:null,HD_VIDEO:null,FHD_VIDEO:null,CUSTOM_VIDEO:null}),m=new (c('FBRTCStruct'))([{IGNORE_CALL:'IgnoreCall'},{HANGUP_CALL:'HangupCall'},{IN_ANOTHER_CALL:'InAnotherCall'},{ACCEPT_AFTER_HANGUP:'CallEndAcceptAfterHangUp'},{NO_ANSWER_TIMEOUT:'NoAnswerTimeout'},{INCOMING_TIMEOUT:'IncomingTimeout'},{OTHER_INSTANCE_HANDLED:'OtherInstanceHandled'},{SIGNALING_MESSAGE_FAILED:'SignalingMessageFailed'},{CONNECTION_DROPPED:'ConnectionDropped'},{CLIENT_INTERRUPTED:'ClientInterrupted'},{WEBRTC_ERROR:'WebRTCError'},{CLIENT_ERROR:'ClientError'},{NO_PERMISSION:'NoPermission'},{OTHER_NOT_CAPABLE:'OtherNotCapable'},{NO_UI_ERROR:'NoUIShown'},{UNSUPPORTED_VERSION:'VersionUnsupported'},{CALLER_NOT_VISIBLE:'CallerNotVisible'},{CARRIER_BLOCKED:'CarrierBlocked'},{OTHER_CARRIER_BLOCKED:'OtherCarrierBlocked'}]),n={REMOTE_PEER_HANGUP:'CollabRemotePeerHangup',REMOTE_PEER_REJECT:'CollabRemotePeerReject',CLOSED_BY_MCU:'CollabClosedByMcu',CLOSED_AS_STALE:'CollabClosedAsStale',CALL_INITIALIZATION_FAILED:'CollabCallInitializationFailed',SIP_CONNECTION_INITIALIZATION_FAILED:'CollabSipConnectionInitializationFailed',LOST_MCU_CONNECTION:'CollabLostMcuConnection',MCU_NO_AUDIO_STREAM:'CollabMcuNoAudioStream',MCU_INVALID_STREAM_CONFIGURATION:'CollabMcuInvalidStreamConfiguration',LOST_MCU_THRIFT_CONNECTION:'CollabLostMcuThriftConnection',LOST_SIP_ADAPTER_THRIFT_CONNECTION:'CollabLostSipAdapterThriftConnection',UNKNOWN:'CollabUnknown'},o={TOGGLE_SELF_VIEW:5,SUBMIT_STAR_RATING:6,SUBMIT_FEEDBACK:7,START_CALL:9,OPEN_SCREEN_IN_NEW:10},p={ONE_HOUR:'1hour',UNTIL_EIGHT_AM:'8am',ALWAYS:'always'},q=c('keyMirror')({VIDEO:null,AUDIO:null,SCREEN_SHARE:null}),r={MULTIWAY:'multiway',P2P:'p2p'},s={NEW:'new',CHECKING:'checking',CONNECTED:'connected',completed:'completed',FAILED:'failed',DISCONNECTED:'disconnected',CLOSED:'closed'},t={PayloadType:h,ChildWindowMessageType:i,UploadLogLevel:j,StreamType:k,VideoQuality:l,CallEndReason:m,CollabCallEndSubreason:n,UIEventType:o,CallBlockingConstants:p,IncomingCallDialogTypes:q,SignalingProtocol:r,IceConnectionState:s,convertFromUploadLogLevel:function u(v){switch(v){case j.LL_DEBUG:return 'd';case j.LL_BASIC:return 'b';case j.LL_WARNING:return 'w';case j.LL_INFO:return 'i';case j.LL_VERBOSE:return 'v';case j.LL_NONE:default:return null;}},convertToUploadLogLevel:function u(v){switch(v){case 'd':return j.LL_DEBUG;case 'b':return j.LL_BASIC;case 'w':return j.LL_WARNING;case 'i':return j.LL_INFO;case 'v':return j.LL_VERBOSE;default:return j.LL_NONE;}},uploadLogLevelString:function u(v){switch(v){case j.LL_BASIC:return 'basic';case j.LL_DEBUG:return 'debug';case j.LL_WARNING:return 'warning';case j.LL_INFO:return 'info';case j.LL_VERBOSE:return 'verbose';default:return '';}},endCallReasonFromString:function u(v){return m.strNames.indexOf(v);},callEndReasonString:function u(v){if(v<0||v>m.strNames.length)return 'Unknown';return m.strNames[v];},fullCallEndReasonString:function u(v,w){return this.callEndReasonString(v)+'_'+(w?'remote':'local');}};f.exports=t;}),null);
__d('FBRTCLogger',['Log','LogHistory','MarauderLogger','formatDate','pageID'],(function a(b,c,d,e,f,g){var h='webrtc',i='sent_message',j='received_message',k='send_succeeded',l='send_failed',m='info',n='call_action',o='client_event',p='client_error',q='type',r='msg_id',s='ack_msg_id',t='call_id',u='from',v='to',w='content',x='tag',y='peer_id',z='error_code',aa='trigger',ba='endcallstats',ca=null;da.getInstance=function(){'use strict';if(!ca)ca=new da();return ca;};function da(){'use strict';this.$FBRTCLogger1=c('LogHistory').getInstance(h);}da.prototype.logToConsole=function(ea){'use strict';var fa='Console';this.$FBRTCLogger2(null,null,fa,ea);this.$FBRTCLogger1.log(fa,ea);};da.prototype.logReceivedMessage=function(ea,fa,ga){'use strict';var ha={};ha[u]=ea;ha[t]=fa;ha[q]=ga.type;ha[r]=ga.msg_id;if(ga.sdp)ha[w]=ga.sdp;if(ga.ack_id)ha[s]=ga.ack_id;this.$FBRTCLogger3(j,ha);this.$FBRTCLogger2(ea,fa,'Received',ga.type+', '+ga.msg_id);};da.prototype.logSentMessage=function(ea,fa,ga){'use strict';var ha={};ha[v]=ea;ha[t]=fa;ha[q]=ga.type;ha[r]=ga.msg_id;if(ga.sdp)ha[w]=ga.sdp;if(ga.ack_id)ha[s]=ga.ack_id;this.$FBRTCLogger3(i,ha);this.$FBRTCLogger2(ea,fa,'Sent',ga.type+', '+ga.msg_id);};da.prototype.logSentMessageSuccess=function(ea,fa,ga,ha){'use strict';var ia={};ia[y]=ea;ia[t]=fa;ia[q]=ga;ia[r]=ha;this.$FBRTCLogger3(k,ia);};da.prototype.logSentMessageFailure=function(ea,fa,ga,ha,ia){'use strict';var ja={};ja[y]=ea;ja[t]=fa;ja[q]=ga;ja[r]=ha;ja[z]=ia;this.$FBRTCLogger3(l,ja);this.$FBRTCLogger2(ea,fa,'Send Failed',ga+', '+ia);};da.prototype.logCallAction=function(ea,fa,ga,ha,ia){'use strict';var ja={};ja[y]=ea;ja[t]=fa;ja[n]=ga;ja[w]=ha;if(ia)ja[aa]=ia;this.$FBRTCLogger3(n,ja);this.$FBRTCLogger2(ea,fa,'CallAction',ga+', '+ha);};da.prototype.logEvent=function(ea,fa,event){'use strict';var ga={};ga[y]=ea;ga[t]=fa;ga[w]=event;this.$FBRTCLogger3(o,ga);this.$FBRTCLogger2(ea,fa,'Event',event);};da.prototype.logInfo=function(ea,fa,ga){'use strict';var ha={};ha[y]=ea;ha[t]=fa;ha[w]=ga;this.$FBRTCLogger3(m,ha);this.$FBRTCLogger2(ea,fa,'Info',ga);};da.prototype.logError=function(ea,fa,ga){'use strict';var ha={};ha[y]=ea;ha[t]=fa;ha[w]=ga;this.$FBRTCLogger3(p,ha);this.$FBRTCLogger2(ea,fa,'Error',ga);};da.prototype.logErrorWithoutID=function(ea){'use strict';this.logError(null,null,ea);};da.prototype.logEndCallSummary=function(ea){'use strict';if(!ea)return;var fa={};fa[y]=ea.peerID;fa[t]=ea.callID;fa[x]=ba;fa[w]=ea.toString();var ga=ea.getExtraInfo();for(var ha in ga)if(Object.prototype.hasOwnProperty.call(ga,ha))fa[ha]=ga[ha];this.$FBRTCLogger3(m,fa);this.$FBRTCLogger2(ea.peerID,ea.callID,'Call Summary',fa);};da.prototype.$FBRTCLogger3=function(ea,fa){'use strict';fa.page_id=c('pageID');this.$FBRTCLogger1.log(ea,fa);c('MarauderLogger').log(ea,h,fa);};da.prototype.$FBRTCLogger2=function(ea,fa,ga,ha){'use strict';};da.CallAction={START_CALL:'start_call',RECEIVED_CALL:'received_call',ANSWER_CALL:'answer_call',END_CALL:'end_call',DENIED_PERMISSION:'denied_permission',SET_MUTE:'set_mute',SET_VIDEO_ON:'set_video_on',SET_SELF_VIEW_ON:'set_self_view_on',SET_FULLSCREEN_ON:'set_fullscreen_on',START_SKYPE:'start_skype',TRY_NEW:'try_new',OPEN_POPUP:'open_popup',POPUP_OPENED:'popup_opened',AUTO_DISABLE_VIDEO:'auto_disable_video',FAILED_GETTING_URI:'failed_getting_uri',OLD_URI:'old_uri',USER_SETTINGS_CHANGED:'user_settings_changed'};da.Trigger={ADMIN_MESSAGE:'admin_message',CHAT_TAB_ICON:'chat_tab_icon',CHAT_TAB_ICON_TOUR:'chat_tab_icon_tour',CHAT_TAB_VOICE_ICON:'chat_tab_voice_icon',SKYPE_DEPRECATION_DIALOG:'skype_deprecation_dialog',REDIAL_BUTTON:'redial_button',RETURN_CALL:'return_call',WEB_MESSENGER:'web_messenger',POPUP_CALL_START_BUTTON:'popup_start_call_button',TIMELINE_PROFILE:'timeline_profile',UNKNOWN:'unknown',RESET_CALL:'install_screen_sharing_ext_dialog',MULTIWAY_CHAT_TAB_SHEET_JOIN_CALL_BUTTON:'multiway_chat_tab_sheet_join_call_button',MULTIWAY_POPUP_START_CALL_BUTTON:'multiway_popup_start_call_button',MULTIWAY_THREAD_HEADER_AUDIO_BUTTON:'multiway_thread_header_audio_button',MULTIWAY_THREAD_HEADER_VIDEO_BUTTON:'multiway_thread_header_video_button',MULTIWAY_THREAD_HEADER_JOIN_AUDIO_CALL_AUDIO_BUTTON:'multiway_thread_header_join_audio_call_audio_button',MULTIWAY_THREAD_HEADER_JOIN_AUDIO_CALL_VIDEO_BUTTON:'multiway_thread_header_join_audio_call_video_button',MULTIWAY_THREAD_HEADER_JOIN_VIDEO_CALL_AUDIO_BUTTON:'multiway_thread_header_join_video_call_audio_button',MULTIWAY_THREAD_HEADER_JOIN_VIDEO_CALL_VIDEO_BUTTON:'multiway_thread_header_join_video_call_video_button',MULTIWAY_THREAD_LIST_JOIN_CALL_BUTTON:'multiway_thread_list_join_call_button'};da.Key={DEVICE_INFO:'device_info',RATING:'rating5',RATING_SHOWN:'rating_shown',SURVEY_CHOICE:'survey_choice',SURVEY_DETAILS:'survey_details',SURVEY_SHOWN:'survey_shown',INITIATED_BY_PAGE_ID:'initiated_by_page_id',PEER_IS_MOBILE:'peer_is_mobile'};f.exports=da;}),null);
__d('FBRTCLocalMessageQueue',['CacheStorage','FBRTCLogger','Map','RTCConfig'],(function a(b,c,d,e,f,g){var h='localstorage',i='RTC_',j='offer',k='offer_msg',l='data_',m=30*1000,n=15*1000,o=500,p=new (c('Map'))();function q(){'use strict';this.$FBRTCLocalMessageQueue1=c('FBRTCLogger').getInstance();}q.prototype.enqueueOffer=function(r,s){'use strict';var t=this.$FBRTCLocalMessageQueue2(r,k);this.$FBRTCLocalMessageQueue3(t,j,s);};q.prototype.getOffer=function(r){'use strict';var s=this.$FBRTCLocalMessageQueue2(r,k);return this.$FBRTCLocalMessageQueue4(s,j);};q.prototype.removeOffer=function(r){'use strict';var s=this.$FBRTCLocalMessageQueue2(r,k);s.remove(j);};q.prototype.enqueueMessage=function(r,s,t,u){'use strict';var v=l+t.toString(),w=p.get(r)||new (c('Map'))();w.set(v,u);p.set(r,w);this.$FBRTCLocalMessageQueue1.logToConsole('Queued '+v);};q.prototype.drainQueue=function(r,s){'use strict';var t=p.get(r)||new (c('Map'))(),u,v;for(var w=t,x=Array.isArray(w),y=0,w=x?w:w[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var z;if(x){if(y>=w.length)break;z=w[y++];}else{y=w.next();if(y.done)break;z=y.value;}var aa=z,u=aa[0],v=aa[1];void u;s(v);}p.set(r,new (c('Map'))());};q.prototype.enableDequeuing=function(r,s,t,u){'use strict';if(u===undefined)u=n;this.$FBRTCLocalMessageQueue5(r,s,t,u);};q.prototype.$FBRTCLocalMessageQueue5=function(r,s,t,u){'use strict';var v=this.$FBRTCLocalMessageQueue2(r,s),w=v.keys(),x=w.length;for(var y=0;y<x;y++){var z=this.$FBRTCLocalMessageQueue6(v,w[y]);if(z&&t)t(z);}this.$FBRTCLocalMessageQueue1.logToConsole('Dequeued '+x+' ('+r+') with '+u+' left)');if(u>0){u-=o;setTimeout(function(){this.$FBRTCLocalMessageQueue5(r,s,t,u);}.bind(this),o);}};q.prototype.$FBRTCLocalMessageQueue3=function(r,s,t){'use strict';var u={__t:Date.now(),__d:t};r.set(s,u);};q.prototype.$FBRTCLocalMessageQueue4=function(r,s){'use strict';var t=r.get(s);if(t&&this.$FBRTCLocalMessageQueue7(t)){return t.__d;}else if(t)r.remove(s);return null;};q.prototype.$FBRTCLocalMessageQueue6=function(r,s){'use strict';var t=this.$FBRTCLocalMessageQueue4(r,s);if(t!==null){r.remove(s);return t;}return null;};q.prototype.$FBRTCLocalMessageQueue7=function(r){'use strict';return Date.now()-r.__t<m;};q.prototype.$FBRTCLocalMessageQueue2=function(r,s){'use strict';return new (c('CacheStorage'))(h,''+i+r+'_'+s+'_');};f.exports=q;}),null);
__d('FBRTCCallControlActions',['FBRTCDispatcher','keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h=c('keyMirror')({ACCEPT_ESCALATION:null,HANG_UP:null,PARENT_WINDOW_START_CALL:null,TOGGLE_FULL_SCREEN:null,TOGGLE_MUTE_AUDIO:null,TOGGLE_MUTE_VIDEO:null,TOGGLE_SCREEN_SHARING:null,TOGGLE_SELF_VIEW:null,SHOW_SETTINGS:null,START_CALL:null,DECLINE_ESCALATION:null,RECEIVED_SIGNALING_MESSAGE:null,RESET_CALL:null,OPEN_SCREEN_IN_NEW:null,CLOSE_STANDALONE_SCREEN:null,REDIAL_CALL:null}),i={Types:h,hangUp:function j(){c('FBRTCDispatcher').dispatch({type:h.HANG_UP});},toggleMuteAudio:function j(){c('FBRTCDispatcher').dispatch({type:h.TOGGLE_MUTE_AUDIO});},toggleMuteVideo:function j(){c('FBRTCDispatcher').dispatch({type:h.TOGGLE_MUTE_VIDEO});},toggleFullScreen:function j(){c('FBRTCDispatcher').dispatch({type:h.TOGGLE_FULL_SCREEN});},toggleSelfView:function j(){c('FBRTCDispatcher').dispatch({type:h.TOGGLE_SELF_VIEW});},showSettings:function j(){c('FBRTCDispatcher').dispatch({type:h.SHOW_SETTINGS});},toggleScreenSharing:function j(){c('FBRTCDispatcher').dispatch({type:h.TOGGLE_SCREEN_SHARING});},startCall:function j(){c('FBRTCDispatcher').dispatch({type:h.START_CALL});},openScreenInNewWindow:function j(){c('FBRTCDispatcher').dispatch({type:h.OPEN_SCREEN_IN_NEW});},receivedSignalingMessage:function j(k){c('FBRTCDispatcher').dispatch({type:h.RECEIVED_SIGNALING_MESSAGE,message_type:k.msgType,message:k});},acceptEscalation:function j(){c('FBRTCDispatcher').dispatch({type:h.ACCEPT_ESCALATION});},declineEscalation:function j(){c('FBRTCDispatcher').dispatch({type:h.DECLINE_ESCALATION});},resetCall:function j(k){c('FBRTCDispatcher').dispatch({type:h.RESET_CALL,trigger:k});},redialCall:function j(){c('FBRTCDispatcher').dispatch({type:h.REDIAL_CALL});},parentWindowStartCall:function j(){c('FBRTCDispatcher').dispatch({type:h.PARENT_WINDOW_START_CALL});}};f.exports=i;}),null);
__d('FBRTCSupport',['ChannelConstants','RTCConfig','UserAgent'],(function a(b,c,d,e,f,g){var h={isSendWebrtcSupported:function i(){return c('RTCConfig').SendNewVCGK;},isReceiveWebrtcSupported:function i(){return c('RTCConfig').ReceiveNewVCGK;},isVideoInteropSupported:function i(){return c('RTCConfig').VideoInteropGK;},isVideoCallBlockingSupported:function i(){return c('RTCConfig').VideoCallBlockingGK;},isWebrtcSupported:function i(){return (c('UserAgent').isBrowser('Chrome >= 28')||c('UserAgent').isBrowser('Firefox >= 25')||c('RTCConfig').RtcUseWebRTCForEdge&&c('UserAgent').isBrowser('Edge >= 15.15042')||c('UserAgent').isBrowser('Opera >= 20'));},isGroupCallWebtrcSupported:function i(){return (c('UserAgent').isBrowser('Chrome >= 28')||c('UserAgent').isBrowser('Opera >= 20'));},isCollabSupported:function i(){return c('RTCConfig').CollabWhitelistedBrowserGK||c('UserAgent').isBrowser('Chrome >= 48');},isOSSupported:function i(){return !c('UserAgent').isPlatform('Android')&&!c('UserAgent').isPlatform('iOS');},getCapabilities:function i(){var j=0;if(this.isReceiveWebrtcSupported())j=c('ChannelConstants').CAPABILITY_VOIP_INTEROP;return j;}};f.exports=h;}),null);
__d('FBRTCMessageListener',['invariant','Arbiter','ChannelConstants','FBRTCConstants','FBRTCCallControlActions','FBRTCLocalMessageQueue','FBRTCSupport','RTCConfig','guid','mixInEventEmitter'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('FBRTCConstants').ChildWindowMessageType,j=45*1000,k=[],l=null,m=null,n=null,o=null,p=null,q=false,r=null,s=void 0,t={init:function u(v,w){if(q)return;q=true;c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('webrtc'),function(y,z){this._onMessage(z.obj);}.bind(this));c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('webrtc_offer'),function(y,z){this._onMessage(z.obj);}.bind(this));c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('webrtc_offerack'),function(y,z){this._onMessage(z.obj);}.bind(this));if(c('RTCConfig').RtcConferencingGK)c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('rtc_multi_json'),function(y,z){this._onMultiwayMessage(z.obj);}.bind(this));this._localMessageQueue=new (c('FBRTCLocalMessageQueue'))();if(c('RTCConfig').PassMessagesBetweenWindowsGK){if(c('FBRTCSupport').isWebrtcSupported()&&window.addEventListener){var x=v?this._handleWindowMessageToChild.bind(this):this._handleWindowMessageToParent.bind(this);window.addEventListener('message',x,false);}if(v)this._connectToParentWindow(w);}},setParentWindowNonce:function u(v){o=v;},generateNewNonce:function u(){p=c('guid')();return p;},setMultiwayMessageHandler:function u(v,w){!r||h(0);r=w?v.bind(w):v;},_onMultiwayMessage:function u(v){this.emit('multiwayMessageReceived',v);if(r)r(v);},setMessageHandler:function u(v,w){!l||h(0);l=w?v.bind(w):v;while(k.length)l(k.shift());},removeMessageHandler:function u(){l=null;},setParentWindowStartCallHandler:function u(v){s=v;return function(){return s=null;};},_onMessage:function u(v){this.emit('messageReceived',v);if(l){l(v);}else k.push(v);this._passMessageToChildWindow(v);},_connectToParentWindow:function u(v){if(window.opener&&window.opener.postMessage){var w={type:i.CHILD_WINDOW_READY,nonce:o,childNonce:this.generateNewNonce(),peerID:v};window.opener.postMessage(w,window.location.origin);}},_verifyWindowMessage:function u(event){return event.origin===window.location.origin&&event.data&&p&&event.data.nonce===p;},_handleWindowMessageToParent:function u(event){if(!this._verifyWindowMessage(event))return;if(event.data.type===i.CHILD_WINDOW_READY){this.setParentWindowNonce(event.data.childNonce);this._setChildWindow(event.source);this._replayQueuedMessagesToChild(event.data.peerID,m);}},_handleWindowMessageToChild:function u(event){if(!this._verifyWindowMessage(event))return;if(event.data.type===i.CHILD_WINDOW_MESSAGE)this._onMessage(event.data.message);if(event.data.type===i.CHILD_WINDOW_START_CALL)if(s){s();}else c('FBRTCCallControlActions').parentWindowStartCall();},_replayQueuedMessagesToChild:function u(v,w){this._localMessageQueue.drainQueue(v,function(x){var y={type:i.CHILD_WINDOW_MESSAGE,nonce:o,message:x};w.postMessage(y,window.location.origin);});},_setChildWindow:function u(v){m=v;clearTimeout(n);n=setTimeout(function(){m=null;},j);this._startCallInChildWindow();this.generateNewNonce();},_passMessageToChildWindow:function u(v){if(m){var w={type:i.CHILD_WINDOW_MESSAGE,nonce:o,message:v};m.postMessage(w,window.location.origin);}},_startCallInChildWindow:function u(){if(m){var v={type:i.CHILD_WINDOW_START_CALL,nonce:o};m.postMessage(v,window.location.origin);}}};c('mixInEventEmitter')(t,{messageReceived:true,multiwayMessageReceived:true});f.exports=t;}),null);
__d("FBRTCVersionDetection",[],(function a(b,c,d,e,f,g){var h={isChrome:function i(){return !!navigator.webkitGetUserMedia;},isFirefox:function i(){return !!navigator.mozGetUserMedia;},webrtcVersion:function i(){if(this.isFirefox())return parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10);if(this.isChrome()){var j=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);if(j!==null){return parseInt(j[2],10);}else return 999;}return 0;}};f.exports=h;}),null);
__d('FBRTCUtils',['emptyFunction','randomInt','AsyncRequest','CurrentUser','FBID','FBRTCConfig','FBRTCConstants','FBRTCVersionDetection','RTCConfig','UserAgent'],(function a(b,c,d,e,f,g){var h=6000,i=window.URL||window.webkitURL,j=typeof document.createElement('video').setSinkId==='function',k={attachMediaStream:function l(m,n){if(window.webkitRTCPeerConnection){if(m.src)i.revokeObjectURL(m.src);if(n){m.src=i.createObjectURL(n);}else m.src='';}else{m.mozSrcObject=n;if(n)m.play();}},reattachMediaStream:function l(m,n){if(window.webkitRTCPeerConnection){m.src=n.src;}else{m.mozSrcObject=n.mozSrcObject;m.play();}},generateRandomInt:function l(){return c('randomInt')(0,4294967294)+1;},aboutEqual:function l(m,n){return m-n<.01&&n-m<.01;},getUploadLogLevel:function l(m){return Math.max(this.getLocalUploadLogLevel(),m);},getLocalUploadLogLevel:function l(){return c('CurrentUser').isEmployee()?c('FBRTCConstants').UploadLogLevel.LL_DEBUG:c('FBRTCConstants').UploadLogLevel.LL_NONE;},sendServerRequest:function l(m,n,o,p,q,r){n=n||c('emptyFunction');o=o||c('emptyFunction');p=p||false;q=q||h;r=r||{};var s=new (c('AsyncRequest'))().setURI(m).setData(r).setAllowCrossPageTransition(true).setHandler(n).setErrorHandler(o).setTimeoutHandler(q,function(){o();});if(p)s.setOption('asynchronous_DEPRECATED',false);s.send();},supportsMultipleStreamsPlanB:function l(){return (c('UserAgent').isBrowser('Chrome')||c('UserAgent').isBrowser('Opera'))&&c('FBRTCVersionDetection').webrtcVersion()>=34;},supportsSetSink:function l(){return j;},isPeerVCEndpoint:function l(m){var n=c('FBRTCConfig').isVCEndpointCall();return n!==undefined?n:m&&!c('FBID').isUser(m)&&c('RTCConfig').CollabVCEndpointsVideoCallGK;}};f.exports=k;}),null);
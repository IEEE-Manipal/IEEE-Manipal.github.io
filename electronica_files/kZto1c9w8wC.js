if (self.CavalryLogger) { CavalryLogger.start_js(["V5ZeK"]); }

__d('StoryComponentVideoPlayerControllerRegistry',['CommercialBreakHostStoryComponentType','EventEmitter','Map'],(function a(b,c,d,e,f,g){'use strict';var h=new (c('EventEmitter'))(),i=new (c('Map'))(),j=new (c('Map'))(),k=new (c('Map'))();function l(o){var p=o,q=[];while(p){q.unshift(p);p=p.parentElement;}return q;}function m(o,p){if(o===null)return null;var q=l(o),r=null,s=null;p.forEach(function(t){var u=t[0],v=t[1],w=l(u);for(var x=0;x<q.length;++x)if(q[x]!==w[x]){if(s===null||x>s){s=x;r=v;}break;}});return r;}var n={registerVideoPlayerController:function o(p,q){var r=p.getVideoID(),s=i.get(r);if(s){s.push(p);}else{s=[p];i.set(r,s);}var t=null;if(q===c('CommercialBreakHostStoryComponentType').POP_OVER_MENU){t=this.findPopoverAsyncMenuForVideoPlayerController(p);}else if(q===c('CommercialBreakHostStoryComponentType').HOST_STORY_HEADER)t=this.findHostStoryControllerForVideoPlayerController(p);if(!t)return;h.emit(t.getInstanceID()+'/register',p);},registerHostStoryController:function o(p,q,r){var s=k.get(q);if(s){s.push(p);}else{s=[p];k.set(q,s);}this._informStoryComponentRegister(p.getContainerElement(),p.getInstanceID(),q,r);},registerPopoverAsyncMenu:function o(p,q,r){var s=p.getInstanceID(),t=j.get(q);if(t){t.push(p);}else{t=[p];j.set(q,t);}this._informStoryComponentRegister(p.getTriggerElement(),s,q,r);},_informStoryComponentRegister:function o(p,q,r,s){h.addListener(q+'/register',s);var t=this.findVideoPlayerControllerForElement(p,r);if(!t)return;h.emit(q+'/register',t);},findVideoPlayerControllerForElement:function o(p,q){var r=i.get(q);if(!r)return null;return m(p,r.map(function(s){return [s.getRootNode(),s];}));},findPopoverAsyncMenuForVideoPlayerController:function o(p){var q=j.get(p.getVideoID());if(!q)return null;return m(p.getRootNode(),q.map(function(r){return [r.getTriggerElement(),r];}));},findHostStoryControllerForVideoPlayerController:function o(p){var q=k.get(p.getVideoID());if(!q)return null;return m(p.getRootNode(),q.map(function(r){return [r.getContainerElement(),r];}));}};f.exports=n;}),null);